Program.Sub.ScreenSU.Start
Gui.FrmOrderReview..Create(DashForm)
Gui.FrmOrderReview..Caption("Open SO/WO Dashboard (6981)")
Gui.FrmOrderReview..Size(14055,8670)
Gui.FrmOrderReview..MinX(0)
Gui.FrmOrderReview..MinY(0)
Gui.FrmOrderReview..Position(0,0)
Gui.FrmOrderReview..BackColor(-2147483633)
Gui.FrmOrderReview..MousePointer(0)
Gui.FrmOrderReview..Event(UnLoad,FrmOrderReview_UnLoad)
Gui.FrmOrderReview..AlwaysOnTop(False)
Gui.FrmOrderReview..FontName("Tahoma")
Gui.FrmOrderReview..FontSize(8.25)
Gui.FrmOrderReview..ControlBox(True)
Gui.FrmOrderReview..MaxButton(True)
Gui.FrmOrderReview..MinButton(True)
Gui.FrmOrderReview..Moveable(True)
Gui.FrmOrderReview..Sizeable(True)
Gui.FrmOrderReview..ShowInTaskBar(True)
Gui.FrmOrderReview..TitleBar(True)
Gui.FrmOrderReview..BarExportButton(True)
Gui.FrmOrderReview..BarRefreshButton(True)
Gui.FrmOrderReview..Event(ExportClick,FrmOrderReview_ExportClick)
Gui.FrmOrderReview..Event(RefreshClick,FrmOrderReview_RefreshClick)
Gui.FrmOrderReview..BarUndoButtons(False,True,True,True)
Gui.FrmOrderReview.acMenuItems.Create(AccordionControl)
Gui.FrmOrderReview.acMenuItems.Enabled(True)
Gui.FrmOrderReview.acMenuItems.Visible(True)
Gui.FrmOrderReview.acMenuItems.Size(3180,7680)
Gui.FrmOrderReview.acMenuItems.Position(0,0)
Gui.FrmOrderReview.acMenuItems.Minimized(False)
Gui.FrmOrderReview.acMenuItems.Dock(3)
Gui.FrmOrderReview.acMenuItems.Event(ElementClick,acMenuItems_ElementClick)
Gui.FrmOrderReview.acMenuItems.AddElement(aceAutoWO,"Auto Work Order Generation","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.acMenuItems.AddElement(aceBOM,"Create/Verify BOM","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.acMenuItems.AddElement(acePart,"Create/Verify Part","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.acMenuItems.AddElement(aceRouter,"Create/Verify Router","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.acMenuItems.AddElement(aceOpenDocs,"Open Part Documents","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.acMenuItems.AddElement(aceNewSO,"New Sales Order","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.acMenuItems.AddElement(aceNewWO,"New Work Order","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.acMenuItems.AddElement(acePrintWODocs,"Print Work Order Documents","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.acMenuItems.AddElement(aceReschedule,"Reschedule Work Order","icon_functions_black",240,240,,-1,0,"",False,True,False,1)
Gui.FrmOrderReview.GsGCAllOpen.Create(GsGridControl)
Gui.FrmOrderReview.GsGCAllOpen.Enabled(True)
Gui.FrmOrderReview.GsGCAllOpen.Visible(True)
Gui.FrmOrderReview.GsGCAllOpen.Zorder(0)
Gui.FrmOrderReview.GsGCAllOpen.Size(10875,7680)
Gui.FrmOrderReview.GsGCAllOpen.Position(3180,0)
Gui.FrmOrderReview.GsGCAllOpen.Event(RowCellClick,GsGCAllOpen_RowCellClick)
Gui.FrmOrderReview.GsGCAllOpen.Event(CellValueChanged,GsGCAllOpen_CellValueChanged)
Gui.FrmOrderReview.GsGCAllOpen.Dock(5)
Gui.FrmOrderReview.framePermissions.Create(Frame)
Gui.FrmOrderReview.framePermissions.Size(4305,450)
Gui.FrmOrderReview.framePermissions.Position(9735,30)
Gui.FrmOrderReview.framePermissions.Enabled(True)
Gui.FrmOrderReview.framePermissions.Visible(True)
Gui.FrmOrderReview.framePermissions.Zorder(0)
Gui.FrmOrderReview.framePermissions.Caption("")
Gui.FrmOrderReview.framePermissions.FontName("Tahoma")
Gui.FrmOrderReview.framePermissions.FontSize(8.25)
Gui.FrmOrderReview.framePermissions.Anchor(9)
Gui.FrmOrderReview.optEdit.Create(Option)
Gui.FrmOrderReview.optEdit.Enabled(True)
Gui.FrmOrderReview.optEdit.Size(645,255)
Gui.FrmOrderReview.optEdit.Position(855,150)
Gui.FrmOrderReview.optEdit.Caption("Edit")
Gui.FrmOrderReview.optEdit.Parent("framePermissions")
Gui.FrmOrderReview.optEdit.Visible(True)
Gui.FrmOrderReview.optEdit.Zorder(0)
Gui.FrmOrderReview.optEdit.FontName("Tahoma")
Gui.FrmOrderReview.optEdit.FontSize(8.25)
Gui.FrmOrderReview.optIssue.Create(Option)
Gui.FrmOrderReview.optIssue.Size(795,240)
Gui.FrmOrderReview.optIssue.Position(1515,150)
Gui.FrmOrderReview.optIssue.Caption("Issue")
Gui.FrmOrderReview.optIssue.Enabled(False)
Gui.FrmOrderReview.optIssue.Parent("framePermissions")
Gui.FrmOrderReview.optIssue.Visible(True)
Gui.FrmOrderReview.optIssue.Zorder(0)
Gui.FrmOrderReview.optIssue.FontName("Tahoma")
Gui.FrmOrderReview.optIssue.FontSize(8.25)
Gui.FrmOrderReview.optWiptoFG.Create(Option)
Gui.FrmOrderReview.optWiptoFG.Size(1080,255)
Gui.FrmOrderReview.optWiptoFG.Position(2325,150)
Gui.FrmOrderReview.optWiptoFG.Caption("Wip to FG")
Gui.FrmOrderReview.optWiptoFG.Enabled(False)
Gui.FrmOrderReview.optWiptoFG.Parent("framePermissions")
Gui.FrmOrderReview.optWiptoFG.Visible(True)
Gui.FrmOrderReview.optWiptoFG.Zorder(0)
Gui.FrmOrderReview.optWiptoFG.FontName("Tahoma")
Gui.FrmOrderReview.optWiptoFG.FontSize(8.25)
Gui.FrmOrderReview.optView.Create(Option)
Gui.FrmOrderReview.optView.Size(765,255)
Gui.FrmOrderReview.optView.Position(75,135)
Gui.FrmOrderReview.optView.Caption("View")
Gui.FrmOrderReview.optView.Parent("framePermissions")
Gui.FrmOrderReview.optView.Enabled(False)
Gui.FrmOrderReview.optView.Visible(True)
Gui.FrmOrderReview.optView.Zorder(0)
Gui.FrmOrderReview.optView.FontName("Tahoma")
Gui.FrmOrderReview.optView.FontSize(8.25)
Gui.FrmOrderReview.optShip.Create(Option)
Gui.FrmOrderReview.optShip.Enabled(False)
Gui.FrmOrderReview.optShip.Size(780,255)
Gui.FrmOrderReview.optShip.Position(3405,150)
Gui.FrmOrderReview.optShip.Parent("framePermissions")
Gui.FrmOrderReview.optShip.Caption("Ship")
Gui.FrmOrderReview.optShip.Visible(True)
Gui.FrmOrderReview.optShip.Zorder(0)
Gui.FrmOrderReview.optShip.FontName("Tahoma")
Gui.FrmOrderReview.optShip.FontSize(8.25)
Gui.FrmOrderReview.progressBar1.Create(ProgressBar)
Gui.FrmOrderReview.progressBar1.Size(1860,255)
Gui.FrmOrderReview.progressBar1.Position(7710,90)
Gui.FrmOrderReview.progressBar1.Visible(False)
Gui.FrmOrderReview.progressBar1.Anchor(9)
Gui.frmSelectVend..Create(BaseForm)
Gui.frmSelectVend..Caption("Select Vendor")
Gui.frmSelectVend..Size(14670,5085)
Gui.frmSelectVend..MinX(0)
Gui.frmSelectVend..MinY(0)
Gui.frmSelectVend..Position(0,0)
Gui.frmSelectVend..BackColor(-2147483633)
Gui.frmSelectVend..MousePointer(0)
Gui.frmSelectVend..Event(UnLoad,frmSelectVend_UnLoad)
Gui.frmSelectVend..AlwaysOnTop(False)
Gui.frmSelectVend..FontName("Tahoma")
Gui.frmSelectVend..FontSize(8.25)
Gui.frmSelectVend..ControlBox(True)
Gui.frmSelectVend..MaxButton(True)
Gui.frmSelectVend..MinButton(True)
Gui.frmSelectVend..Moveable(True)
Gui.frmSelectVend..Sizeable(True)
Gui.frmSelectVend..ShowInTaskBar(True)
Gui.frmSelectVend..TitleBar(True)
Gui.frmSelectVend.gsgcLines.Create(GsGridControl)
Gui.frmSelectVend.gsgcLines.Size(14280,2790)
Gui.frmSelectVend.gsgcLines.Position(90,885)
Gui.frmSelectVend.gsgcLines.Event(RowCellClick,gsgcLines_RowCellClick)
Gui.frmSelectVend.gsgcLines.Enabled(True)
Gui.frmSelectVend.gsgcLines.Visible(True)
Gui.frmSelectVend.gsgcLines.Zorder(0)
Gui.frmSelectVend.cmdVendBrw.Create(Button)
Gui.frmSelectVend.cmdVendBrw.Size(855,375)
Gui.frmSelectVend.cmdVendBrw.Position(2850,210)
Gui.frmSelectVend.cmdVendBrw.Caption("^")
Gui.frmSelectVend.cmdVendBrw.Event(Click,cmdVendBrw_Click)
Gui.frmSelectVend.cmdVendBrw.Enabled(True)
Gui.frmSelectVend.cmdVendBrw.Visible(True)
Gui.frmSelectVend.cmdVendBrw.Zorder(0)
Gui.frmSelectVend.cmdVendBrw.FontName("Tahoma")
Gui.frmSelectVend.cmdVendBrw.FontSize(8.25)
Gui.frmSelectVend.cmdNewPO.Create(Button)
Gui.frmSelectVend.cmdNewPO.Size(1500,375)
Gui.frmSelectVend.cmdNewPO.Position(105,3780)
Gui.frmSelectVend.cmdNewPO.Caption("Create PO")
Gui.frmSelectVend.cmdNewPO.Event(Click,cmdNewPO_Click)
Gui.frmSelectVend.cmdNewPO.Enabled(True)
Gui.frmSelectVend.cmdNewPO.Visible(True)
Gui.frmSelectVend.cmdNewPO.Zorder(0)
Gui.frmSelectVend.cmdNewPO.FontName("Tahoma")
Gui.frmSelectVend.cmdNewPO.FontSize(8.25)
Gui.frmSelectVend.txtVendorNo.Create(TextBox,"",True,2640,300,0,105,240,False,0,"Arial",8,-2147483643,1)
Gui.frmSelectVend.chkCopySOExtraDesc.Create(CheckBox)
Gui.frmSelectVend.chkCopySOExtraDesc.Size(2640,300)
Gui.frmSelectVend.chkCopySOExtraDesc.Position(4485,195)
Gui.frmSelectVend.chkCopySOExtraDesc.Caption("Copy SO Extra Description")
Gui.frmSelectVend.chkCopySOExtraDesc.Enabled(True)
Gui.frmSelectVend.chkCopySOExtraDesc.Visible(True)
Gui.frmSelectVend.chkCopySOExtraDesc.Zorder(0)
Gui.frmSelectVend.chkCopySOExtraDesc.FontName("Tahoma")
Gui.frmSelectVend.chkCopySOExtraDesc.FontSize(8.25)
Gui.FormMassUpdate..Create(BaseForm)
Gui.FormMassUpdate..Caption("Mass Update")
Gui.FormMassUpdate..Size(2520,2505)
Gui.FormMassUpdate..MinX(0)
Gui.FormMassUpdate..MinY(0)
Gui.FormMassUpdate..Position(0,0)
Gui.FormMassUpdate..AlwaysOnTop(False)
Gui.FormMassUpdate..FontName("Tahoma")
Gui.FormMassUpdate..FontSize(8.25)
Gui.FormMassUpdate..ControlBox(True)
Gui.FormMassUpdate..MaxButton(True)
Gui.FormMassUpdate..MinButton(True)
Gui.FormMassUpdate..MousePointer(0)
Gui.FormMassUpdate..Moveable(True)
Gui.FormMassUpdate..Sizeable(True)
Gui.FormMassUpdate..ShowInTaskBar(True)
Gui.FormMassUpdate..TitleBar(True)
Gui.FormMassUpdate..Event(UnLoad,FormMassUpdate_UnLoad)
Gui.FormMassUpdate.dtpMassUpdate.Create(DatePicker)
Gui.FormMassUpdate.dtpMassUpdate.Enabled(True)
Gui.FormMassUpdate.dtpMassUpdate.Visible(True)
Gui.FormMassUpdate.dtpMassUpdate.Zorder(0)
Gui.FormMassUpdate.dtpMassUpdate.Size(1500,300)
Gui.FormMassUpdate.dtpMassUpdate.Position(495,555)
Gui.FormMassUpdate.dtpMassUpdate.CheckBox(False)
Gui.FormMassUpdate.dtpMassUpdate.FontName("Tahoma")
Gui.FormMassUpdate.dtpMassUpdate.FontSize(8.25)
Gui.FormMassUpdate.cmdMassUpdate.Create(Button)
Gui.FormMassUpdate.cmdMassUpdate.Enabled(True)
Gui.FormMassUpdate.cmdMassUpdate.Visible(True)
Gui.FormMassUpdate.cmdMassUpdate.Zorder(0)
Gui.FormMassUpdate.cmdMassUpdate.Size(1125,345)
Gui.FormMassUpdate.cmdMassUpdate.Position(690,1305)
Gui.FormMassUpdate.cmdMassUpdate.Caption("")
Gui.FormMassUpdate.cmdMassUpdate.FontName("Tahoma")
Gui.FormMassUpdate.cmdMassUpdate.FontSize(8.25)
Gui.FormMassUpdate.cmdMassUpdate.Event(Click,cmdMassUpdate_Click)
Gui.FormMassUpdate.cmdMassUpdate.SvgPicture("icon_save_all_color")
Gui.FormMassUpdate.cmdMassUpdate.ImageAlign(8)
Gui.FormMassUpdate.lbl1.Create(Label,"New SO Due Date",True,1440,195,0,525,240,True,0,"Tahoma",8.25,,0,0)
Gui.FormMassUpdate.lbl1.BorderStyle(0)
Gui.FormMassUpdate.lbl1.FontStyle(True,False,False,False,False)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
V.Global.bLoadData.Declare
V.Global.bLongPart.Declare
v.Global.bShipOEPermission.Declare
v.Global.bShipSHIPPermission.Declare
v.Global.bShip.Declare
V.Global.iPrintAudit.Declare
V.Global.bFlexProcEdit.Declare

''Change Scheduling to be forward!!!
'Program.External.Include.Library("175100.lib")
'Program.External.Include.Library("300011.lib")
'Program.External.Include.Library("500030.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
	F.Intrinsic.Control.Try
	F.Intrinsic.Control.If(V.Caller.Hook,=,"11560")
		V.Passed.000201.Set("SO/WO Dash.")
	F.Intrinsic.Control.Else
		V.Local.sError.Declare
		
		V.Local.sIcon.Declare
		V.Local.sGssLogo.Declare
'		
'		F.Intrinsic.String.Build("{0}\ART\gss2.ico",V.Caller.GlobalDir,v.Local.sIcon)
'		F.Intrinsic.String.Build("{0}\ART\GAB_GSS_Logo_Green_Dash.png",V.Caller.GlobalDir,V.Local.sGssLogo)
'		'Gui.frmWeb..Icon(V.Local.sIcon)
'		Gui.FrmOrderReview..Icon(V.Local.sIcon)
'		'Gui.FrmOrderReview.picGSSLogo.Picture(V.Local.sGssLogo)
		
		F.ODBC.Connection!con.OpenCompanyConnection(500)
		
		V.Global.bLoadData.Set(False)
		
		F.Intrinsic.Control.CallSub(SetContextMenus)
		F.Intrinsic.Control.CallSub(CheckLongPart)
		F.Intrinsic.Control.CallSub(CheckPermissions)
		f.Intrinsic.Control.CallSub(GetUserFields)
		F.Intrinsic.Control.CallSub(checktable)
		
		
		'Check Print Audit Option
		F.Global.General.ReadOption(400367,3,0000,V.Global.iPrintAudit)
		
		'Gui.FrmOrderReview.optView.Value(True)
	
		Gui.FrmOrderReview..Show
		F.Intrinsic.Control.CallSub(loaddtall)
'		F.Intrinsic.Control.CallSub(loadgvall)
		F.Intrinsic.Control.CallSub(Deserialize)
		
		
		
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.FrmOrderReview_UnLoad.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	'Closing the connection if it is open
	f.Intrinsic.Control.If(v.ODBC.con.exists,=,"1") 	
	    f.ODBC.Connection!con.Close
	f.Intrinsic.Control.EndIf
	
	'Closing screen
	GUI.FrmOrderReview..Visible(False)
	
	'Ending program
	F.Intrinsic.Control.End
	
F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
F.Intrinsic.Control.EndTry
Program.Sub.FrmOrderReview_UnLoad.End

Program.Sub.CheckLongPart.Start
	F.Global.General.ReadOption("400861",0,False,"0000",V.Global.bLongPart)
	F.Intrinsic.Control.If(V.Global.bLongPart,=,False)
		F.Global.General.ReadOption("400861",0,False,"0004",V.Global.bLongPart)
	F.Intrinsic.Control.EndIf
Program.Sub.CheckLongPart.End

Program.Sub.LoadDTAll.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	V.Local.sMark.Declare
	v.Local.sCMarkFile.Declare
	v.Local.sSearch.Declare
	V.Local.sret.Declare
	v.Local.i.Declare
	V.Local.sSQL.Declare
	V.Local.sDept.Declare
	V.Local.sCurOper.Declare
	V.Local.dCurOperDate.Declare
	V.Local.sNextOper.Declare
	V.Local.sOutside.Declare
	V.Local.dShipDate.Declare
	V.Local.fPcsRem.Declare
	V.Local.fEstHrs.Declare
	V.Local.fRemHrs.Declare
	V.Local.dDateCheck.Declare
	
	f.Intrinsic.String.Concat(v.Caller.GasDir,"\GAB_5219_COMPLETION.txt",v.Local.sCMarkFile)
	f.Intrinsic.File.File2String(v.Local.sCMarkFile,v.Local.sMark)
	
	'Gui.FrmOrderReview.lblStatus.Caption("Loading Sales Orders....")
	'Gui.FrmOrderReview.lblStatus.Visible(True)
	Gui.FrmOrderReview.progressBar1.Value(0)
	Gui.FrmOrderReview.progressBar1.Visible(True)

	F.Intrinsic.Control.If(V.DataTable.dtAll.Exists)
		F.Data.DataTable.Close("dtAll")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtMulti.Exists)
		f.Data.DataTable.Close("dtMulti")
	F.Intrinsic.Control.EndIf
	
	V.Global.bLoadData.Set(True)
'	F.Data.DataTable.CreateFromSQL("dtAll","con","Select CONVERT(0,SQL_BIT) as 'ScheduleWO', '' as 'PrtDocCntrl',   ' ' as 'PartExists', ' ' as 'RtrCompl', ' ' as 'BomCompl', A.Date_Order As SOOrderDate, RTrim(B.Name_Customer) As Name_Customer, C.Customer_PO,C.PROJECT as PROJECT_NO,O.DESCR as PROJ_DESC,rtrim(C.USER_1) as HEAD_USER_1,rtrim(C.USER_2) as HEAD_USER_2,rtrim(C.USER_3) as HEAD_USER_3,rtrim(C.USER_4) as HEAD_USER_4,rtrim(C.USER_5) as HEAD_USER_5, C.CODE_SORT AS 'CODE_SORT',A.Order_No As SO,Left(A.Record_No,3) As SOLine,  RTRIM(A.Part) As SOPart,A.Description, A.Qty_Ordered As SOQty, A.PRICE, A.EXTENSION, A.UM_ORDER, Case A.Flag_Use_Mqd When 'Y' Then E.Cust_Due_Date Else A.Date_Item_Prom End As SODueDate, CONVERT(0,SQL_INTEGER) as 'QTY_ONHAND',  A.QTY_SHIPPED as ShipQTY, G.Job As WO, G.Suffix, Case G.Date_Due When '1900-01-01' Then Null Else G.Date_Due End As WODueDate, Rtrim(A.User_1) as 'User_1', Rtrim(A.User_2) as 'PO', rtrim(A.User_3) as 'POLine', Case When If(J.Date_Due_Line Is Null,M.Date_Due_Line,J.Date_Due_Line) = '1900-01-01' Then Null Else If(J.Date_Due_Line Is Null,M.Date_Due_Line,J.Date_Due_Line) End As PODueDate, C.Salesperson, rtrim(A.Part) as 'PartFriendly', H.Notes,   A.User_4, CAST(CASE WHEN G.FLAG_WO_PRTD = 'Y' OR G.FLAG_WO_PRTD = 'R' THEN 1 ELSE 0 END AS BIT) AS PRINTED, CAST(CASE WHEN G.FLAG_WO_RELEASED = 'Y' THEN 1 ELSE 0 END AS BIT) AS RELEASED, '' as 'JobDocCntrl',  CONVERT(0,SQL_BIT) as 'WOCreated',  '' as 'CODE_SOURCE',  concat(G.JOB,G.SUFFIX) as 'JS',   C.ORDER_SORT_2,RTrim(D.Name) As SPName,A.Line_Type As SOType,A.Location As SOLoc, A.Product_Line, Cast(Case A.Flag_Use_Mqd When 'Y' Then 1 Else 0 End As Bit) As SOShipSched,G.Part As WOPart,G.Location As WOLoc,G.Qty_Order As WOQty,Case G.Scheduled_Due_Date When '1900-01-01' Then Null Else G.Scheduled_Due_Date End As WOSchedDate, Cast(Case G.Date_Closed When '1900-01-01' Then 0 Else 1 End As Bit) As WOClsd,If(J.Part Is Null,M.Part,J.Part) As POPart,If(J.Location Is Null,M.Location,J.Location) As POLoc,ifnull(If(J.Qty_Order Is Null,M.Qty_Order,J.Qty_Order),0) As POQty,  Cast(Case When If(J.Flag_Recv_Close Is Null,M.Flag_Recv_Close,J.Flag_Recv_Close) = 'Y' Then 1 When If(K.Flag_Recv_Closed Is Null,N.Flag_Recv_Closed,K.Flag_Recv_Closed) = 'Y' Then 1 Else 0 End As Bit) As POClsd,'' As POType, A.User_5, rtrim(A.Part) as 'GSSPart',A.Customer,Case A.Flag_Use_Mqd When 'Y' Then E.Qty_Open Else A.Qty_BO End As SOBOQty, RTRIM(A.FLAG_COGS) AS FLAG_COGS,A.INFO_1,A.INFO_2,left(A.Part,17) as 'ACTPART',Right(A.Part,3) as 'ACTREV' From V_Order_Lines A Left Join V_Customer_Master B On A.Customer = B.Customer Left Join V_Order_Header C On A.Order_No = C.Order_No Left Join V_PROJECT_MASTER O On C.PROJECT = O.PROJECT Left Join V_Salespersons D On C.Salesperson = D.ID Left Join V_OE_Ship_Sched E On A.Order_No = E.Order_No And A.Record_No = E.Order_Line And E.Flag_Closed <> 'Y' Left Join V_Order_To_WO F On A.Order_No = F.Order_No And A.Record_No = F.Order_Line Left Join V_Job_Header G On F.Job = G.Job And F.Suffix = G.Suffix Left Join Gab_4167_SO_Notes H On A.Order_No = H.SO And A.Record_No = Concat(H.SOLINE,0) Left Join V_Sales_Ord_Com I On A.Order_No = I.Order_No And A.Record_No = I.Order_Line Left Join V_PO_Lines J On A.USER_2 = J.PURCHASE_ORDER  And A.USER_3 = J.RECORD_NO Left Join V_PO_Header K On A.USER_2 = K.Purchase_Order Left Join V_PO_Drop_Ship L On A.Order_No = L.Order_No And A.Record_No = L.Order_Line Left Join V_PO_Lines M On L.PO = M.Purchase_Order And L.PO_Line = M.Record_No Left Join V_PO_Header N On M.Purchase_Order = N.Purchase_Order Where SOBOQty >= 0 Order By A.Date_Item_Prom;",True)
'	f.Data.DataTable.CreateFromSQL("dtMulti","con","SELECT * FROM JOB_MULT_PARTS_LN",true)
	'F.Data.DataTable.CreateFromSQL("dtAll","con","Select CONVERT(0,SQL_BIT) as 'ScheduleWO',      concat(G.JOB,G.SUFFIX) as 'JS',  CONVERT(0,SQL_BIT) as 'WOCreated',  '' as 'CODE_SOURCE', Case G.Scheduled_Due_Date When '1900-01-01' Then Null Else G.Scheduled_Due_Date End As WOSchedDate, C.ORDER_SORT_2,RTrim(D.Name) As SPName,A.Line_Type As SOType,A.Location As SOLoc, A.Product_Line, Cast(Case A.Flag_Use_Mqd When 'Y' Then 1 Else 0 End As Bit) As SOShipSched,G.Part As WOPart,G.Location As WOLoc,G.Qty_Order As WOQty,  Cast(Case G.Date_Closed When '1900-01-01' Then 0 Else 1 End As Bit) As WOClsd,If(J.Part Is Null,M.Part,J.Part) As POPart,If(J.Location Is Null,M.Location,J.Location) As POLoc,ifnull(If(J.Qty_Order Is Null,M.Qty_Order,J.Qty_Order),0) As POQty, Cast(Case When If(J.Flag_Recv_Close Is Null,M.Flag_Recv_Close,J.Flag_Recv_Close) = 'Y' Then 1 When If(K.Flag_Recv_Closed Is Null,N.Flag_Recv_Closed,K.Flag_Recv_Closed) = 'Y' Then 1 Else 0 End As Bit) As POClsd,'' As POType,'' As Status, A.User_5, rtrim(A.Part) as 'GSSPart',A.Customer,Case A.Flag_Use_Mqd When 'Y' Then E.Qty_Open Else A.Qty_BO End As SOBOQty,  CAST(CASE WHEN G.FLAG_WO_PRTD = 'Y' OR G.FLAG_WO_PRTD = 'R' THEN 1 ELSE 0 END AS BIT) AS PRINTED, CAST(CASE WHEN G.FLAG_WO_RELEASED = 'Y' THEN 1 ELSE 0 END AS BIT) AS RELEASED,  '' as 'JobDocCntrl' From V_Order_Lines A Left Join V_Customer_Master B On A.Customer = B.Customer Left Join V_Order_Header C On A.Order_No = C.Order_No Left Join V_Salespersons D On C.Salesperson = D.ID Left Join V_OE_Ship_Sched E On A.Order_No = E.Order_No And A.Record_No = E.Order_Line And E.Flag_Closed <> 'Y' Left Join V_Order_To_WO F On A.Order_No = F.Order_No And A.Record_No = F.Order_Line Left Join V_Job_Header G On F.Job = G.Job And F.Suffix = G.Suffix Left Join Gab_4167_SO_Notes H On A.Order_No = H.SO And A.Record_No = Concat(H.SOLINE,0) Left Join V_Sales_Ord_Com I On A.Order_No = I.Order_No And A.Record_No = I.Order_Line Left Join V_PO_Lines J On A.USER_2 = J.PURCHASE_ORDER  And A.USER_3 = J.RECORD_NO Left Join V_PO_Header K On A.USER_2 = K.Purchase_Order Left Join V_PO_Drop_Ship L On A.Order_No = L.Order_No And A.Record_No = L.Order_Line Left Join V_PO_Lines M On L.PO = M.Purchase_Order And L.PO_Line = M.Record_No Left Join V_PO_Header N On M.Purchase_Order = N.Purchase_Order Where SOBOQty >= 0 Order By A.Date_Item_Prom;",True)
	
	'Order_lines
	F.Data.Datatable.CreateFromSQL("dtOrderLines","con","select Date_Order As SOOrderDate, Order_No As SO,Left(Record_No,3) As SOLine,  RTRIM(Part) As SOPart,Description, Qty_Ordered As SOQty, PRICE, EXTENSION, UM_ORDER,   QTY_SHIPPED as ShipQTY,  Rtrim(User_1) as 'User_1', Rtrim(User_2) as 'PO', rtrim(User_3) as 'POLine', rtrim(Part) as 'PartFriendly',  User_4,  Line_Type As SOType,Location As SOLoc, Product_Line, Cast(Case Flag_Use_Mqd When 'Y' Then 1 Else 0 End As Bit) As SOShipSched, '' As POType, User_5, rtrim(Part) as 'GSSPart',Customer, RTRIM(FLAG_COGS) AS FLAG_COGS,INFO_1,INFO_2,left(Part,17) as 'ACTPART',Right(Part,3) as 'ACTREV', Flag_Use_Mqd, Date_Item_Prom, Qty_BO, MUST_DLVR_BY_DATE from V_Order_Lines")
	' if(Date_Item_Prom = '1900-01-01', NULL, Date_Item_Prom) as 
	'Customer_Master
	F.Data.Datatable.CreateFromSQL("dtCustomerMaster","con","select Customer, RTrim(Name_Customer) As Name_Customer from V_Customer_Master;")
	'Order_Header
	F.Data.Datatable.CreateFromSQL("dtOrderHeader","con","select ORDER_NO, Customer_PO, PROJECT as PROJECT_NO, rtrim(USER_1) as HEAD_USER_1, rtrim(USER_2) as HEAD_USER_2, rtrim(USER_3) as HEAD_USER_3, rtrim(USER_4) as HEAD_USER_4, rtrim(USER_5) as HEAD_USER_5, CODE_SORT AS 'CODE_SORT', Salesperson, rtrim(ORDER_SORT_2) as ORDER_SORT_2 from V_ORDER_HEADER;")
	'Project_Master
	F.Data.Datatable.CreateFromSQL("dtProjectMaster","con","select Project, DESCR as PROJ_DESC from V_Project_Master;")
	
	'Date_item_Prom = due date/promise date
	'MUST_DLVR_BY_DATE = Cust Due Date - ADD
	'HEADER USER_1 ADD
	'LEAD TIME
	
	F.Data.Linq.Join(V.Enum.LinqJoinType!LeftJoin,V.Enum.LinqSourceType!DataTable,"dtOrderLines*!*MSTR",V.Enum.LinqSourceType!DataTable,"dtCustomerMaster*!*CUST","MSTR.Customer = CUST.Customer",V.Enum.LinqSourceType!DataTable,"dtOrderHeader*!*HEAD","MSTR.SO = HEAD.ORDER_NO",V.Enum.LinqSourceType!DataTable,"dtProjectMaster*!*PROJ","HEAD.PROJECT_NO = PROJ.Project","*","","","","dtTemp1",True)
	F.Data.Datatable.RemoveColumn("dtTemp1","Customer1")
	F.Data.Datatable.RemoveColumn("dtTemp1","ORDER_NO")
	F.Data.Datatable.RemoveColumn("dtTemp1","Project")
	F.Data.Datatable.Close("dtOrderLines")
	F.Data.Datatable.Close("dtCustomerMaster")
	F.Data.Datatable.Close("dtOrderHeader")
	F.Data.Datatable.Close("dtProjectMaster")
	
	'Salespersons
	F.Data.Datatable.CreateFromSQL("dtSalespersons","con","select "ID", RTrim(Name) As SPName from V_Salespersons;")
	'OE_Ship_Sched
	F.Data.Datatable.CreateFromSQL("dtOEShipSched","con","select Order_No, Order_Line, min(Cust_Due_Date) as Cust_Due_Date from V_OE_Ship_Sched where Flag_Closed <> 'Y' group by Order_No, Order_Line;")
	F.Data.Datatable.CreateFromSQL("dtOEShipSchedQty","con","select Order_No, Order_Line, Cust_Due_Date, Qty_Open from V_OE_Ship_Sched where Flag_Closed <> 'Y';")
	
	
	F.Data.Linq.Join(V.Enum.LinqJoinType!LeftJoin,V.Enum.LinqSourceType!DataTable,"dtTemp1*!*MSTR",V.Enum.LinqSourceType!DataTable,"dtSalespersons*!*SALESP","MSTR.Salesperson = SALESP.ID",V.Enum.LinqSourceType!DataTable,"dtOEShipSched*!*SHIPDATE","MSTR.SO = SHIPDATE.ORDER_NO and MSTR.SOLine = SHIPDATE.ORDER_LINE",V.Enum.LinqSourceType!DataTable,"dtOEShipSchedQty*!*SHIPQTY","MSTR.SO = SHIPQTY.ORDER_NO and MSTR.SOLINE = SHIPQTY.ORDER_LINE and SHIPDATE.Cust_Due_Date = SHIPQTY.Cust_Due_Date","*","","","","dtTemp2",True)
	F.Data.Datatable.RemoveColumn("dtTemp2","ID")
	F.Data.Datatable.RemoveColumn("dtTemp2","Order_no")
	F.Data.Datatable.RemoveColumn("dtTemp2","ORder_Line")
	F.Data.Datatable.RemoveColumn("dtTemp2","Order_No1")
	F.Data.Datatable.RemoveColumn("dtTemp2","Order_Line1")
	F.Data.Datatable.RemoveColumn("dtTemp2","Cust_Due_Date1")
	F.Data.Datatable.Close("dtTemp1")
	F.Data.Datatable.Close("dtSalespersons")
	F.Data.Datatable.Close("dtOEShipSched")
	F.Data.Datatable.Close("dtOEShipSchedQty")

	
	F.Data.Datatable.AddExpressionColumn("dtTemp2","SOBOQty","Float","iif(FLAG_USE_MQD = 'Y', Qty_Open, Qty_BO)")
	'Case A.Flag_Use_Mqd When 'Y' Then E.Qty_Open Else A.Qty_BO End As SOBOQty, (Filter where SOBOQty > 0)
	F.Data.Datatable.AddExpressionColumn("dtTemp2","SODueDateTEMP","DateTime","iif([Flag_Use_Mqd] = 'Y', Cust_Due_Date, Date_Item_Prom)")
	'Case A.Flag_Use_Mqd When 'Y' Then E.Cust_Due_Date Else A.Date_Item_Prom End As SODueDate,
	F.Data.Datatable.AddExpressionColumn("dtTemp2","SOLINETOT","String","SO + SOLine")
	F.Data.Dictionary.CreateFromDataTable("dDueDate","dtTemp2","SOLINETOT","SODueDateTEMP")
	F.Data.Datatable.AddColumn("dtTemp2","SODueDate","DateTime")
	F.Data.Datatable.FillFromDictionary("dtTemp2","dDueDate","SOLINETOT","SODueDate")
	F.Data.Dictionary.Close("dDueDate")
	F.Data.Datatable.RemoveColumn("dtTemp2","SODueDateTEMP")
	F.Data.Datatable.RemoveColumn("dtTemp2","SOLINETOT")
	
	'Order_To_WO
	F.Data.Datatable.CreateFromSQL("dtOrderToWO","con","select Order_No, left(Order_Line, 3) as Order_Line, JOB, SUFFIX from V_Order_To_WO;")
	'JOB_HEADER
	F.Data.Datatable.CreateFromSQL("dtJobHeader","con","select Job As WO, Suffix, Case Date_Due When '1900-01-01' Then Null Else Date_Due End As WODueDate, CAST(CASE WHEN FLAG_WO_PRTD = 'Y' OR FLAG_WO_PRTD = 'R' THEN 1 ELSE 0 END AS BIT) AS PRINTED, CAST(CASE WHEN FLAG_WO_RELEASED = 'Y' THEN 1 ELSE 0 END AS BIT) AS RELEASED, concat(JOB,SUFFIX) as 'JS', Part As WOPart,Location As WOLoc,Qty_Order As WOQty,Case Scheduled_Due_Date When '1900-01-01' Then Null Else Scheduled_Due_Date End As WOSchedDate, Cast(Case Date_Closed When '1900-01-01' Then 0 Else 1 End As Bit) As WOClsd from V_JOB_HEADER;")
	'GAB_4167_SO_NOTES
	F.Data.Datatable.CreateFromSQL("dt4167Notes","con","select SO, SOLINE, Notes from GAB_4167_SO_NOTES;")

	'INVENTORY_MSTR
	F.Data.Datatable.CreateFromSQL("dtInvMast","con","SELECT RTRIM(PART) AS INV_PART, LOCATION AS INV_LOC, TIME_MATERIAL_LEAD AS LEAD_TIME FROM INVENTORY_MSTR;")
	'Flex Sched Hist
	'F.Data.DataTable.CreateFromSQL("dtFlexSchedHist","con","Select Job, Suffix, Flex_Sched, Processed as Flex_Proc from MOB_FLEX_HIST")
	
	F.Data.Linq.Join(V.Enum.LinqJoinType!LeftJoin,V.Enum.LinqSourceType!DataTable,"dtTemp2*!*MSTR",V.Enum.LinqSourceType!DataTable,"dtOrderToWO*!*SOtoWO","MSTR.SO = SOtoWO.ORDER_NO and MSTR.SOLINE = SOtoWO.ORDER_LINE",V.Enum.LinqSourceType!DataTable,"dtJobHeader*!*JOB","SOtoWO.JOB = JOB.WO and SOtoWO.Suffix = JOB.SUFFIX",V.Enum.LinqSourceType!DataTable,"dt4167Notes*!*NOTES","MSTR.SO = NOTES.SO and MSTR.SOLine = NOTES.SOLINE",V.Enum.LinqSourceType!DataTable,"dtInvMast*!*INV","MSTR.SOPart = INV.INV_PART AND MSTR.SOLoC = INV.INV_LOC","*","MSTR.SOBOQty > 0","","","dtTemp3",True)
	F.Data.Datatable.RemoveColumn("dtTemp3","ORDER_NO")
	F.Data.Datatable.RemoveColumn("dtTemp3","ORDER_LINE")
	F.Data.Datatable.RemoveColumn("dtTemp3","JOB")
	F.Data.Datatable.RemoveColumn("dtTemp3","SUFFIX1")
	F.Data.Datatable.RemoveColumn("dtTemp3","SO1")
	F.Data.Datatable.RemoveColumn("dtTemp3","SOLINE1")
	F.Data.Datatable.RemoveColumn("dtTemp3","Qty_Open")
	F.Data.Datatable.RemoveColumn("dtTemp3","Qty_BO")
	F.Data.Datatable.RemoveColumn("dtTemp3","Flag_Use_Mqd")
	F.Data.Datatable.RemoveColumn("dtTemp3","Cust_Due_Date")
	F.Data.Datatable.RemoveColumn("dtTemp3","Date_Item_Prom")
	F.Data.Datatable.RemoveColumn("dtTemp3","INV_PART")
	F.Data.Datatable.RemoveColumn("dtTemp3","INV_LOC")
	'F.Data.Datatable.RemoveColumn("dtTemp3","JOB1")
	'F.Data.Datatable.RemoveColumn("dtTemp3","SUFFIX2")
	'F.Data.Datatable.RemoveColumn("dtTemp3","Flex_Sched")
	F.Data.Datatable.Close("dtTemp2")
	F.Data.Datatable.Close("dtOrderToWO")
	F.Data.Datatable.Close("dtJobHeader")
	F.Data.Datatable.Close("dt4167Notes")
	
	'F.Data.DataView.Create("dtTemp3","dvNullFix",22,"isnull(Flex_Proc, False) = False","")
	'F.Data.DataView.SetValue("dtTemp3","dvNullFix",-1,"FLEX_PROC",False)
	
	'Sales_Ord_Com
'	F.Data.Datatable.CreateFromSQL("dtSalesOrderCom","con","select Order_No, left(Order_Line, 3) as OrderLine from V_Sales_Ord_Com;")
	'PO_LINES
	F.Data.Datatable.CreateFromSQL("dtPOLines","con","select PURCHASE_ORDER, Record_No, Date_Due_Line, Part, Location, Qty_Order, Flag_Recv_Close from V_PO_LINES;")
	'PO_Header
	F.Data.Datatable.CreateFromSQL("dtPOHeader","con","select PURCHASE_ORDER, Flag_Recv_Closed from V_PO_Header;")
	'PO_Drop_Ship
	F.Data.Datatable.CreateFromSQL("dtPODropShip","con","select Order_No, Order_Line, PO, PO_Line from V_PO_Drop_Ship;")
	
	F.Data.Linq.Join(V.Enum.LinqJoinType!LeftJoin,V.Enum.LinqSourceType!DataTable,"dtTemp3*!*MSTR",V.Enum.LinqSourceType!DataTable,"dtPOLines*!*LINESA","MSTR.PO = LINESA.PURCHASE_ORDER and MSTR.POLINE = LINESA.RECORD_NO",V.Enum.LinqSourceType!DataTable,"dtPODropShip*!*DROP","MSTR.SO = DROP.ORder_NO and MSTR.SOLine = DROP.ORDER_LINE",V.Enum.LinqSourceType!DataTable,"dtPOLines*!*LINESB","DROP.PO = LINESB.PURCHASE_ORDER and DROP.PO_LINE = LINESB.RECORD_NO",V.Enum.LinqSourceType!DataTable,"dtPOHeader*!*POHEADA","MSTR.PO = POHEADA.PURCHASE_ORDER",V.Enum.LinqSourceType!DataTable,"dtPOHeader*!*POHEADB","DROP.PO = POHEADB.PURCHASE_ORDER","*","","","","dtTemp4",True)
	F.Data.Datatable.RemoveColumn("dtTemp4","PURCHASE_ORDER")
	F.Data.Datatable.RemoveColumn("dtTemp4","RECORD_NO")
	F.Data.Datatable.RemoveColumn("dtTemp4","ORder_NO")
	F.Data.Datatable.RemoveColumn("dtTemp4","ORDER_LINE")
	F.Data.Datatable.RemoveColumn("dtTemp4","PURCHASE_ORDER1")
	F.Data.Datatable.RemoveColumn("dtTemp4","RECORD_NO1")
	F.Data.Datatable.RemoveColumn("dtTemp4","PURCHASE_ORDER2")
	F.Data.Datatable.RemoveColumn("dtTemp4","PURCHASE_ORDER3")
	F.Data.Datatable.RemoveColumn("dtTemp4","PO1")
	F.Data.Datatable.RemoveColumn("dtTemp4","PO_LINE")
	F.Data.Datatable.Close("dtTemp3")
	F.Data.Datatable.Close("dtPOLines")
	F.Data.Datatable.Close("dtPOHeader")
	F.Data.Datatable.Close("dtPODropShip")
	
	F.Data.Datatable.AddColumn("dtTemp4","ScheduleWO","Boolean",False)
	'CONVERT(0,SQL_BIT) as 'ScheduleWO',
	F.Data.Datatable.AddColumn("dtTemp4","PrtDocCntrl","String")
	''' as 'PrtDocCntrl',
	F.Data.Datatable.AddColumn("dtTemp4","PartExists","String")
	'' ' as 'PartExists',
	F.Data.Datatable.AddColumn("dtTemp4","RtrCompl","String")
	'' ' as 'RtrCompl',
	F.Data.Datatable.AddColumn("dtTemp4","BomCompl","String")
	'' ' as 'BomCompl',
	F.Data.Datatable.AddColumn("dtTemp4","QTY_ONHAND","Long",0)
	'CONVERT(0,SQL_INTEGER) as 'QTY_ONHAND',
	F.Data.Datatable.AddColumn("dtTemp4","JobDocCntrl","String")
	''' as 'JobDocCntrl', 
	F.Data.Datatable.AddColumn("dtTemp4","WOCreated","Boolean",False)
	'CONVERT(0,SQL_BIT) as 'WOCreated',
	F.Data.Datatable.AddColumn("dtTemp4","CODE_SOURCE","String")
	''' as 'CODE_SOURCE',
	F.Data.Datatable.AddExpressionColumn("dtTemp4","PODueDate","DateTime","isnull(Date_Due_Line, Date_Due_Line1)")
	'Case When If(J.Date_Due_Line Is Null,M.Date_Due_Line,J.Date_Due_Line) = '1900-01-01' Then Null Else If(J.Date_Due_Line Is Null,M.Date_Due_Line,J.Date_Due_Line) End As PODueDate,
	F.Data.Datatable.AddExpressionColumn("dtTemp4","POPart","String","isnull(PART, PART1)")
	'If(J.Part Is Null,M.Part,J.Part) As POPart,
	F.Data.Datatable.AddExpressionColumn("dtTemp4","POLoc","String","isnull(Location, Location1)")
	'If(J.Location Is Null,M.Location,J.Location) As POLoc,
	F.Data.Datatable.AddExpressionColumn("dtTemp4","POQty","Float","isnull(Qty_Order, Qty_Order1)")
	'ifnull(If(J.Qty_Order Is Null,M.Qty_Order,J.Qty_Order),0) As POQty,
	F.Data.Datatable.AddExpressionColumn("dtTemp4","POClsd","Boolean","iif(isnull(FLAG_RECV_CLOSE, FLAG_RECV_CLOSE1) = 'Y', True, iif(isnull(FLAG_RECV_CLOSED, FLAG_RECV_CLOSED1) = 'Y', True, False))")
	'Cast(Case When If(J.Flag_Recv_Close Is Null,M.Flag_Recv_Close,J.Flag_Recv_Close) = 'Y' Then 1 When If(K.Flag_Recv_Closed Is Null,N.Flag_Recv_Closed,K.Flag_Recv_Closed) = 'Y' Then 1 Else 0 End As Bit) As POClsd,
	
	F.Data.DataView.Create("dtTemp4","dvTranslate")
	F.Data.DataView.ToDataTable("dtTemp4","dvTranslate","dtAll",True)
	F.Data.Datatable.Close("dtTemp4")
'	F.Data.DataView.Create("dtAll","dvNull",22,"isnull(SODueDate, #1/1/1900#) = #1/1/1900#","")
'	F.Data.DataView.SetValue("dtAll","dvNull",-1,"SODueDate",V.Ambient.DBNull)
'	F.Data.DataView.Close("dtAll","dvNull")
'	F.Data.Datatable.SetValue("dtAll",-1,"SODueDate",V.Ambient.MinDate)
	
	F.Data.Datatable.RemoveColumn("dtAll","Date_Due_line")
	F.Data.Datatable.RemoveColumn("dtAll","Date_Due_line1")
	F.Data.Datatable.RemoveColumn("dtAll","PART")
	F.Data.Datatable.RemoveColumn("dtAll","PART1")
	F.Data.Datatable.RemoveColumn("dtAll","Location")
	F.Data.Datatable.RemoveColumn("dtAll","Location1")
	F.Data.Datatable.RemoveColumn("dtAll","Qty_Order")
	F.Data.Datatable.RemoveColumn("dtAll","Qty_Order1")
	F.Data.Datatable.RemoveColumn("dtAll","FLAG_RECV_CLOSE")
	F.Data.Datatable.RemoveColumn("dtAll","FLAG_RECV_CLOSE1")
	F.Data.Datatable.RemoveColumn("dtAll","FLAG_RECV_CLOSED")
	F.Data.Datatable.RemoveColumn("dtAll","FLAG_RECV_CLOSED1")
	
	F.Data.Datatable.AddColumn("dtAll","CUR_OPER",String)
	F.Data.Datatable.AddColumn("dtAll","NEXT_OPER",String)
	
	'Fill in PO Type
	F.Data.DataTable.AddExpressionColumn("dtAll","POKey",String,"PO+POLine")
	f.Intrinsic.Control.If(v.Global.bLongPart)
		F.Data.DataTable.AddDisplayPartColumn("dtAll",0,"SOPart","DISPLAY_PART")
		F.Data.DataTable.CopyColumn("dtAll","Display_part","PartFriendly")
		F.Data.DataTable.CopyColumn("dtAll","Display_part","SOPart")
		F.Data.DataTable.CopyColumn("dtAll","Display_part","WOPart")
	f.Intrinsic.Control.Else
		F.Data.DataTable.AddDisplayPartColumn("dtAll",0,"SOPart","DISPLAY_PART")
	f.Intrinsic.Control.EndIf

	
	f.Data.DataTable.AddColumn("dtAll","Router",string)
	f.Data.Dictionary.CreateFromSQL("dRout","con","SELECT rtrim(PART), MEMO_2 as 'Router' FROM V_BOM_ENG")
	f.Data.Dictionary.SetDefaultReturn("dRout","")
	f.Data.DataTable.FillFromDictionary("dtAll","dRout","SOPart","Router")
	f.Data.Dictionary.Close("dRout")
	
	gui.FrmOrderReview.progressBar1.Value(15)

	f.Data.Dictionary.CreateFromSQL("dSrc","con","SELECT rtrim(PART), if(CODE_SOURCE='P','PS',IF(CODE_SOURCE='J','PJ',IF(CODE_SOURCE='F','MJ',IF(CODE_SOURCE='M','MS','')))) AS 'CODE_SOURCE' FROM V_INVENTORY_MST2")
	f.Data.Dictionary.SetDefaultReturn("dSrc","")
	f.Data.DataTable.FillFromDictionary("dtAll","dSRC","GSSPART","CODE_SOURCE")
	F.Data.Dictionary.Close("dSrc")
	'Part ExistsF
	'f.Data.DataTable.AddColumn("dtAll","PartExists",Boolean,false)
	f.Data.Dictionary.CreateFromSQL("dINVE","con","SELECT rtrim(PART) as 'Part', CONVERT(1,SQL_BIT) as 'Exists' FROM V_INVENTORY_MSTR")
	f.Data.Dictionary.SetDefaultReturn("dINVE","")
	f.Data.DataTable.FillFromDictionary("dtAll","dINVE","GSSPART","PartExists")
	f.Data.Dictionary.Close("dINVE")
	'Part Onhand quantity
	'F.Data.DataTable.AddColumn("dtAll","QTY_ONHAND",float,0)
	f.Data.Dictionary.CreateFromSQL("dInv","con","SELECT rtrim(PART) as 'Part', QTY_ONHAND FROM V_INVENTORY_MSTR")
	F.Data.Dictionary.SetDefaultReturn("dInv","0")
	f.Data.DataTable.FillFromDictionary("dtAll","dInv","GSSPART","QTY_ONHAND")
	f.Data.Dictionary.Close("dInv")
	'Router Complete, need to be on 2017.1
	'F.Data.DataTable.AddColumn("dtAll","RtrCompl",Boolean,False)
	F.Data.Dictionary.CreateFromSQL("dRtrCompl","con","Select rtrim(Rtr_Num) as 'Rtr-Num',Complete From V_Router_Supp_Hdr Where Complete = 1;")
	F.Data.Dictionary.SetDefaultReturn("dRtrCompl","")
	F.Data.DataTable.FillFromDictionary("dtAll","dRtrCompl","GSSPART","RtrCompl")
	F.Data.Dictionary.Close("dRtrCompl")
	'Bom Complete
	'F.Data.DataTable.AddColumn("dtAll","BomCompl",Boolean,False)
	F.Data.Dictionary.CreateFromSQL("dBomCompl","con","Select rtrim(Parent) as 'Parent',Cast(1 As Bit) As Bom_Compl From V_Bom_Mstr Where Sequence_Bom = '0000' And Bom_Complete = 'Y';")
	F.Data.Dictionary.SetDefaultReturn("dBomCompl","")
	F.Data.DataTable.FillFromDictionary("dtAll","dBomCompl","GSSPART","BomCompl")
	F.Data.Dictionary.Close("dBomCompl")
	'Doc control for part
	F.Data.DataTable.SetValue("dtAll",-1,"PrtDocCntrl","DCS-OFF")
	F.Data.Dictionary.CreateFromSQL("dDCC","con","Select rtrim(ID) As Part,'DCS-ON' As DCC From Link_Data Where Type = '00030'")
	F.Data.Dictionary.SetDefaultReturn("dDCC","DCS-OFF")
	F.Data.DataTable.FillFromDictionary("dtAll","dDCC","GSSPart","PrtDocCntrl")
	F.Data.Dictionary.Close("dDCC")
	'Doc control for Job
	F.Data.DataTable.SetValue("dtAll",-1,"JobDocCntrl","DCS-OFF")
	F.Data.Dictionary.CreateFromSQL("dDCC","con","Select RTRIM(ID) As Part,'DCS-ON' As DCC From Link_Data Where Type = '00020'")
	F.Data.Dictionary.SetDefaultReturn("dDCC","DCS-OFF")
	F.Data.DataTable.FillFromDictionary("dtAll","dDCC","JS","JobDocCntrl")
	F.Data.Dictionary.Close("dDCC")

	
	gui.FrmOrderReview.progressBar1.Value(30)
	
	F.Data.DataView.Create("dtAll","dvWO")
	F.Data.DataView.SetFilter("dtAll","dvWO","[WO] <> ''")
	F.Data.Datatable.CreateFromSQL("dtAPSLines","con","select A.JOB,A.SFX,right(A.JSS, 6) as SEQ,A.SEQTYPE,rtrim(A.SEQRES) as SEQRES,A.PCSREMAIN,A.STARTDATE,IF(WORK_GROUP <> '',D.WC_DEPT,B.WC_DEPT) AS DEPT, A.OPCODE AS OPCODE FROM APSV3_JBLINES A LEFT JOIN WORKCENTERS B ON A.SEQRES = B.MACHINE LEFT JOIN WORKGROUP_HEAD C ON A.SEQRES = C.WORK_GROUP LEFT JOIN WORKCENTERS D ON C.PROTOTYPE_WC = D.MACHINE where A.SEQTYPE <> 2 and A.COMPLDATE is null order by A.JOB, A.SFX, A.SEQ;",False)
	F.Data.Linq.Join(V.Enum.LinqJoinType!InnerJoin,V.Enum.LinqSourceType!DataView,"dtAll","dvWO*!*ALL",V.Enum.LinqSourceType!DataTable,"dtAPSLines*!*APS","ALL.WO = APS.JOB and ALL.Suffix = APS.SFX","ALL.WO*!*ALL.Suffix*!*min(APS.SEQ) as CURSEQ","","ALL.WO,ALL.Suffix","","dtCurSeq",False)
	F.Data.DataTable.AddExpressionColumn("dtCurSeq","CUR_SEQ","String","substring('000000' + convert([CURSEQ], 'System.String'), len(convert([CURSEQ], 'System.String')) + 1, 6)")
	F.Data.Linq.Join(V.Enum.LinqJoinType!LeftJoin,V.Enum.LinqSourceType!DataTable,"dtCurSeq*!*SEQ",V.Enum.LinqSourceType!DataTable,"dtAPSLines*!*APS","SEQ.WO = APS.JOB and SEQ.Suffix = APS.SFX and SEQ.CUR_SEQ = APS.SEQ","SEQ.WO*!*SEQ.Suffix*!*SEQ.CUR_SEQ*!*APS.SEQRES as CUR_OPER","","","","dtCurOper",False)
	F.Data.Datatable.Close("dtCurSeq")
	F.Data.Linq.Join(V.Enum.LinqJoinType!InnerJoin,V.Enum.LinqSourceType!DataTable,"dtCurOper*!*CUR",V.Enum.LinqSourceType!DataTable,"dtAPSLines*!*APS","CUR.WO = APS.JOB and CUR.Suffix = APS.SFX","CUR.WO*!*CUR.Suffix*!*CUR.CUR_SEQ*!*CUR.CUR_OPER*!*APS.SEQ","","","","dtFutureSeqs",False)
	F.Data.Datatable.AddExpressionColumn("dtFutureSeqs","GROUP_CHK","Boolean","[CUR_SEQ] <> [SEQ]")
	F.Data.Linq.Join(V.Enum.LinqJoinType!LeftJoin,V.Enum.LinqSourceType!DataTable,"dtCurOper*!*CUR",V.Enum.LinqSourceType!DataTable,"dtFutureSeqs*!*NEXT","CUR.WO = NEXT.WO and CUR.Suffix = NEXT.Suffix","CUR.WO*!*CUR.Suffix*!*CUR.CUR_SEQ*!*CUR.CUR_OPER*!*min(NEXT.SEQ) as NEXTSEQ","NEXT.GROUP_CHK = True","CUR.WO,CUR.Suffix,CUR.CUR_SEQ,CUR.CUR_OPER","","dtNextSeq",False)
	F.Data.Datatable.Close("dtFutureSeqs")
	F.Data.Datatable.Close("dtCurOper")
	F.Data.DataTable.AddExpressionColumn("dtNextSeq","NEXT_SEQ","String","substring('000000' + convert([NEXTSEQ], 'System.String'), len(convert([NEXTSEQ], 'System.String')) + 1, 6)")
	F.Data.Linq.Join(V.Enum.LinqJoinType!LeftJoin,V.Enum.LinqSourceType!DataTable,"dtNextSeq*!*SEQ",V.Enum.LinqSourceType!DataTable,"dtAPSLines*!*APS","SEQ.WO = APS.JOB and SEQ.Suffix = APS.SFX and SEQ.NEXT_SEQ = APS.SEQ","SEQ.WO*!*SEQ.Suffix*!*SEQ.CUR_SEQ*!*SEQ.CUR_OPER*!*SEQ.NEXT_SEQ*!*APS.SEQRES as NEXT_OPER","","","","dtNextOper",False)
	F.Data.Datatable.Close("dtNextSeq")
	F.Data.DataTable.Close("dtAPSLines")
	F.Data.DataView.Close("dtAll","dvWO")
	
	F.Data.Datatable.AddExpressionColumn("dtNextOper","WOSFX","String","[WO] + [Suffix]")
	F.Data.Dictionary.CreateFromDataTable("dCurOper","dtNextOper","WOSFX","CUR_OPER")
	F.Data.Dictionary.CreateFromDataTable("dNextOper","dtNextOper","WOSFX","NEXT_OPER")
	F.Data.Datatable.Close("dtNextOper")
	F.Data.Dictionary.SetDefaultReturn("dCurOper","")
	F.Data.Dictionary.SetDefaultReturn("dNextOper","")
	F.Data.Datatable.FillFromDictionary("dtAll","dCurOper","JS","CUR_OPER")
	F.Data.Datatable.FillFromDictionary("dtAll","dNextOper","JS","NEXT_OPER")
	F.Data.Dictionary.Close("dCurOper")
	F.Data.Dictionary.Close("dNextOper")
	
	F.Intrinsic.String.Build("iif([PartExists] = 'True', '{0}', '')",V.Local.sMark,V.Local.sCurOper)
	F.Data.Datatable.AddExpressionColumn("dtAll","PartExistsMark","String",V.Local.sCurOper)
	F.Intrinsic.String.Build("iif([RtrCompl] = 'True', '{0}', '')",V.Local.sMark,V.Local.sCurOper)
	F.Data.Datatable.AddExpressionColumn("dtAll","RtrComplMark","String",V.Local.sCurOper)
	F.Intrinsic.String.Build("iif([BomCompl] = 'True', '{0}', '')",V.Local.sMark,V.Local.sCurOper)
	F.Data.Datatable.AddExpressionColumn("dtAll","BomComplMark","String",V.Local.sCurOper)
	
	

	gui.FrmOrderReview.progressBar1.Value(45)
	F.Data.Datatable.AddExpressionColumn("dtAll","Status1","String","iif(trim([WO]) = '' and trim([PO]) = '', '1', '')") ' No WO/PO
	F.Data.Datatable.AddExpressionColumn("dtAll","Status2","String","iif(trim([WO]) <> '' and trim([PO]) = '', iif(trim([SOPart]) <> trim([WOPart]) and trim([SOLoc]) <> trim([WOLoc]), '2', ''), '')") ' Part Mismatch
	F.Data.Datatable.AddExpressionColumn("dtAll","Status3","String","iif(trim([WO]) <> '' and trim([PO]) = '', iif([SODueDate] < [WODueDate], '3', ''), '')") ' Date Mismatch
	F.Data.Datatable.AddExpressionColumn("dtAll","Status4","String","iif(trim([WO]) <> '' and trim([PO]) = '', iif([SOQty] <> [WOQty], '4', ''), '')") ' Qty Mismatch
	F.Data.Datatable.AddExpressionColumn("dtAll","Status5","String","iif([ShipQty] >= [SOQty], '5', '')") ' Ready to Invoice
	F.Data.Datatable.AddExpressionColumn("dtAll","Status","String","iif([Status5] = '5', '5', iif(len([Status1] + [Status2] + [Status3] + [Status4] + [Status5]) = 0, '0', iif(len([Status1] + [Status2] + [Status3] + [Status4] + [Status5]) = 1, [Status1] + [Status2] + [Status3] + [Status4] + [Status5], '-1')))")
	F.Data.DataTable.AddExpressionColumn("dtAll","StatusMsg","String","iif([Status] = '0', 'No Issue', iif([Status] = '1', 'No WO/PO', iif([Status] = '2', 'Part Mismatch', iif([Status] = '3', 'Date Mismatch', iif([Status] = '4', 'Qty Mismatch', iif([Status] = '5', 'Ready to Invoice', 'Multi Issue'))))))")
	
	
	gui.FrmOrderReview.progressBar1.Value(65)
	F.Intrinsic.Control.CallSub(LoadGVAll)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTAll.End

Program.Sub.LoadGVAll.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.sStatus.Declare
	V.Local.sStatus2.Declare
	V.Local.sSelect.Declare
	v.Local.sStatusMSG.Declare
	v.Local.dtempdate.Declare
	v.Local.lret.Declare
	v.Local.lCol.Declare
	V.Local.iVisibleIndex.Declare
	V.Local.sRet.Declare
	
	v.Local.dtempdate.Set("1/1/1900")
'	Gui.FrmOrderReview.progressBar1.Min(0)
'	Gui.FrmOrderReview.progressBar1.Max(100)


	gui.FrmOrderReview.progressBar1.Value(75)
	Gui.FrmOrderReview.GsGCAllOpen.AddGridViewFromDataTable("gvAll","dtAll")
	Gui.FrmOrderReview.GsGCAllOpen.SuspendLayout()
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","OptionsViewShowGroupPanel",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","MultiSelect",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","AllowSort",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","AllowFilter",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","OptionsDetailShowDetailTabs",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","OptionsViewColumnAutoWidth",False)
	gui.FrmOrderReview.GsGCAllOpen.SetGridviewProperty("gvAll","OptionsFindAlwaysVisible",True)
	gui.FrmOrderReview.GsGCAllOpen.SetGridviewProperty("gvAll","OptionsFindAlwaysVisible",True)
	'GUI.FrmOrderReview.GsGCAllOpen.SetGridviewProperty("gvAll", V.Enum.GridViewPropertyNames!MultiselectMode, 2)
	
	'GSS CI Arturo Almaguer modification 7/11/22
	'Adding gv property to supress 1/1/1900 dates = null dates
	GUI.FrmOrderReview.GsGCAllOpen.SetGridviewProperty("gvAll", V.Enum.GridViewPropertyNames!SuppressNothingDates, True)
	'''''''''''''''''''''''''''''''''''''''''''''''''''
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","AllowShowHide",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","AllowShowHide",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","AllowShowHide",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status1","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status1","AllowShowHide",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status2","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status2","AllowShowHide",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status3","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status3","AllowShowHide",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status4","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status4","AllowShowHide",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status5","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status5","AllowShowHide",False)
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","Fixed","Left")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_Proc","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","Fixed","Left")
	
	V.Local.iVisibleIndex.Set(-1)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","VisibleIndex",V.Local.iVisibleIndex.++)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLEX_PROC","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ROUTER","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","VisibleIndex",V.Local.iVisibleIndex.++)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJECT_NO","VisibleIndex",V.Local.iVisibleIndex.++)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJ_DESC","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_1","VisibleIndex",V.Local.iVisibleIndex.++)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_2","VisibleIndex",V.Local.iVisibleIndex.++)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_3","VisibleIndex",V.Local.iVisibleIndex.++)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_4","VisibleIndex",V.Local.iVisibleIndex.++)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_5","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","LEAD_TIME","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","USER_1","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","VisibleIndex",V.Local.iVisibleIndex.++)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_no","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CUR_OPER","VisibleIndex",V.Local.iVisibleIndex.++)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","VisibleIndex",V.Local.iVisibleIndex.++)
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","Visible",False)
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","Visible",False)
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","DISPLAY_PART","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","GSSPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ACTPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ACTREV","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLOC","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRINTED","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RELEASED","Visible",False)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROC","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POKEY","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JS","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPNAME","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_1","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_2","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQTY","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Price","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Extension","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","Visible",False)	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","Visible",False)	
	
	gui.FrmOrderReview.GsGCAllOpen.ColumnEdit("gvAll","Printed","EditorButton","Print")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","Caption","Customer")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","Caption","Customer Name")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","Caption","Customer PO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","Caption","SO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","Caption","SO Line")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","Caption","Salesperson")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","Caption","SP Name")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","Caption","SO Type")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","Caption","SO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","Caption","SO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","Caption","PL")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","Caption","Description")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","Caption","SO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","Caption","SO BO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","Caption","SO Entered")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","Caption","SO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","Caption","Cust Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","LEAD_TIME","Caption","Lead Time (Days)")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","Caption","SO Ship Sched")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","Caption","WO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","Caption","Print WO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","Caption","Released")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Price","Caption","Price")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Extension","Caption","Extension")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","Caption","COGS")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLEX_PROC","Caption","Issued")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","Caption","Suffix")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","Caption","WO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","Caption","WO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","Caption","WO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","Caption","WO Sched Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","Caption","WO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","Caption","WO Clsd")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","Caption","User 2")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","Caption","User 3")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","Caption","PO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","Caption","PO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","Caption","PO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","Caption","PO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","Caption","PO Clsd")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","Caption","PO Type")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","Caption","Code")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","Caption","Notes")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","Caption","User 1")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","Caption","User 4")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","Caption","User 5")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","Caption","Rtr")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","Caption","Bom")	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","Caption","Part Friendly")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","Caption","Select")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","Caption","Proc.")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","Caption","SO Line Description")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","Caption","Order Sort")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","Caption","Order Sort 2")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","Caption","Source")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","Caption","QOH")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","Caption","Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","Caption","UM SO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQTY","Caption","Shipped")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","Caption","Status")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_1","Caption","Info_1")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_2","Caption","Info_2")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","Width","125")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","MinWidth","125")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","Width","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","MinWidth","100")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","Width","100")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","Width","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","Width","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","Width","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","Width","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","MinWidth","40")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","MinWidth","45")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","Width","45")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_1","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_2","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","LEAD_TIME","MinWidth","55")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLEX_PROC","MinWidth","75")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","LEAD_TIME","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_1","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_2","AllowEdit",False)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLEX_PROC","AllowEdit",False)

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_1","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_2","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","LEAD_TIME","ReadOnly",True)

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQTY","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RELEASED","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRINTED","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_1","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_2","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","LEAD_TIME","HeaderFontBold",True)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLEX_PROC","HeaderFontBold",True)
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_1","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_2","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","LEAD_TIME","HeaderHAlignment","Center")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLEX_PROC","HeaderHAlignment","Center")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrComplMark","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomComplMark","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Code_source","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExistsMark","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRINTED","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RELEASED","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_1","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","INFO_2","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","LEAD_TIME","CellHAlignment","Center")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLINE","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","CellForeColor","Blue")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","CellForeColor","Blue")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","CellForeColor","Blue")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","CellBackColor","LightYellow")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","CellBackColor","LightYellow")
	GUI.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","CellBackColor","LightYellow")
	'F.Intrinsic.Control.If(V.Global.bFlexProcEdit)
		'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLEX_PROC","CellBackColor","LightYellow")
	'F.Intrinsic.Control.EndIf

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","MUST_DLVR_BY_DATE","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","DisplayCustomDatetime","d")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","DisplayCustomNumeric","£#,###,###,##0.00")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","DisplayCustomNumeric","£#,###,###,##0.00")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","DisplayCustomNumeric","#,###,###,##0.00")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","DisplayCustomNumeric","#,###,###,##0.00")
	
	'Formatting for added columns - HEADER_USER_1,HEADER_USER_2,HEADER_USER_3,HEADER_USER_4,HEADER_USER_5,PROJECT,PROJ_DESCR,ROUTER
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_1","Caption","Acknowledgment Status")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_2","Caption","User 2 (Header)")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_3","Caption","User 3 (Header)")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_4","Caption","User 4 (Header)")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_5","Caption","User 5 (Header)")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJECT_NO","Caption","Project No")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJ_DESC","Caption","Project Name")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ROUTER","Caption","Router")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CUR_OPER","Caption","Cur Op")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","Caption","Next Op")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","Caption","Next Op")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_no","Caption","Nest Flex")
		
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_1","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_2","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_3","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_4","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_5","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJECT_NO","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJ_DESC","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ROUTER","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CUR_OPER","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","Visible",False)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_no","Visible",True)
		
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_1","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_1","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_2","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_2","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_3","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_3","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_4","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_4","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_5","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_5","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJECT_NO","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJECT_NO","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJ_DESC","MinWidth","175")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJ_DESC","Width","175")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ROUTER","MinWidth","175")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ROUTER","Width","175")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CUR_OPER","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CUR_OPER","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","Width","75")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_no","MinWidth","75")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_no","Width","75")
		
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_1","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_2","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_3","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_4","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_5","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJECT_NO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJ_DESC","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ROUTER","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CUR_OPER","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","AllowEdit",False)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_no","AllowEdit",False)	
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_1","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_2","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_3","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_4","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_5","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJECT_NO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJ_DESC","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ROUTER","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CUR_OPER","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","HeaderFontBold",True)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_no","HeaderFontBold",True)	
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_1","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_2","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_3","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_4","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","HEAD_USER_5","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJECT_NO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROJ_DESC","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ROUTER","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CUR_OPER","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","NEXT_OPER","HeaderHAlignment","Center")
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Flex_no","HeaderHAlignment","Center")	
	
	gui.FrmOrderReview.progressBar1.Value(80)
	
	Gui.FrmOrderReview.GsGCAllOpen.AddSummaryItem("gvAll","EXTENSION","SUM_EXTENSION","Sum","","","n")
	
	GUI.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvall","RtrComplMark",v.Local.lCol)
	
	'Part Document Control
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Icon","DCS-OFF")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Caption","Part Doc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Visible",True)
	F.Data.DataTable.Select("dtAll","PrtDocCntrl = 'DCS-ON'",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect.IsNotNoReturn)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
'		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
'			gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvall","PrtDocCntrl",v.Local.lret)
'			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvAll",v.Local.lret,V.Local.sSelect(V.Local.iCnt),"Icon","DCS-ON")
'		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	'Job Document Control
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","Icon","DCS-OFF")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","Caption","Job Doc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","Visible",False)
	F.Data.DataTable.Select("dtAll","JobDocCntrl = 'DCS-ON'",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect.IsNotNoReturn)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
'		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
'			gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvall","JobDocCntrl",v.Local.lret)
'			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvAll",v.Local.lret,V.Local.sSelect(V.Local.iCnt),"Icon","DCS-ON")
'		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	gui.FrmOrderReview.progressBar1.Value(95)
	'User Field Titles
	F.Data.DataTable.Select("dtUserFields","Key_ID='01'",v.Local.sRet)
	F.Intrinsic.Control.If(v.Local.sRet,=,"***NORETURN***")
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","USER_1","Caption","User 1")
	F.Intrinsic.Control.Else
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","USER_1","Caption",v.DataTable.dtUserFields(v.Local.sret).Label!FieldVal)
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Select("dtUserFields","Key_ID='02'",v.Local.sRet)
	F.Intrinsic.Control.If(v.Local.sRet,=,"***NORETURN***")
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","Caption","User 2")
	F.Intrinsic.Control.Else
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","Caption",v.DataTable.dtUserFields(v.Local.sret).Label!FieldVal)
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Select("dtUserFields","Key_ID='03'",v.Local.sRet)
	F.Intrinsic.Control.If(v.Local.sRet,=,"***NORETURN***")
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","Caption","User 1")
	F.Intrinsic.Control.Else
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","Caption",v.DataTable.dtUserFields(v.Local.sret).Label!FieldVal)
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Select("dtUserFields","Key_ID='04'",v.Local.sRet)
	F.Intrinsic.Control.If(v.Local.sRet,=,"***NORETURN***")
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","USER_4","Caption","User 1")
	F.Intrinsic.Control.Else
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","USER_4","Caption",v.DataTable.dtUserFields(v.Local.sret).Label!FieldVal)
	F.Intrinsic.Control.EndIf
	
	F.Data.DataTable.Select("dtUserFields","Key_ID='05'",v.Local.sRet)
	F.Intrinsic.Control.If(v.Local.sRet,=,"***NORETURN***")
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","USER_5","Caption","User 1")
	F.Intrinsic.Control.Else
		Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","USER_5","Caption",v.DataTable.dtUserFields(v.Local.sret).Label!FieldVal)
	F.Intrinsic.Control.EndIf
	
	
'	gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvall","StatusMsg",v.Local.lCol)
	
	
	Gui.FrmOrderReview.GsGCAllOpen.AddStyleFormatCondition("gvAll","StatusMsg","Status1","Expression","[Status] = '1'")
	Gui.FrmOrderReview.GsGCAllOpen.SetStyleFormatConditionProperty("gvAll","StatusMsg","Status1",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorWhite.Highlight)
	Gui.FrmOrderReview.GsGCAllOpen.AddStyleFormatCondition("gvAll","StatusMsg","Status2","Expression","[Status] = '2'")
	Gui.FrmOrderReview.GsGCAllOpen.SetStyleFormatConditionProperty("gvAll","StatusMsg","Status2",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorYellow.Highlight)
	Gui.FrmOrderReview.GsGCAllOpen.AddStyleFormatCondition("gvAll","StatusMsg","Status3","Expression","[Status] = '3'")
	Gui.FrmOrderReview.GsGCAllOpen.SetStyleFormatConditionProperty("gvAll","StatusMsg","Status3",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorPurple.Highlight)
	Gui.FrmOrderReview.GsGCAllOpen.AddStyleFormatCondition("gvAll","StatusMsg","Status4","Expression","[Status] = '4'")
	Gui.FrmOrderReview.GsGCAllOpen.SetStyleFormatConditionProperty("gvAll","StatusMsg","Status4",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorRed.Highlight)
	Gui.FrmOrderReview.GsGCAllOpen.AddStyleFormatCondition("gvAll","StatusMsg","Status5","Expression","[Status] = '5'")
	Gui.FrmOrderReview.GsGCAllOpen.SetStyleFormatConditionProperty("gvAll","StatusMsg","Status5",V.Enum.ConditionalPropertyNames!BackColor,V.Enum.ThemeColors!ColorGreen.Highlight)
	Gui.FrmOrderReview.GsGCAllOpen.AddStyleFormatCondition("gvAll","StatusMsg","StatusMult","Expression","[Status] = '-1'")
	Gui.FrmOrderReview.GsGCAllOpen.SetStyleFormatConditionProperty("gvAll","StatusMsg","StatusMult",V.Enum.ConditionalPropertyNames!BackColor,V.Color.Red)
	Gui.FrmOrderReview.GsGCAllOpen.SetStyleFormatConditionProperty("gvAll","StatusMsg","StatusMult",V.Enum.ConditionalPropertyNames!ForeColor,V.Color.White)


	Gui.FrmOrderReview.GsGCAllOpen.ResumeLayout()
	Gui.FrmOrderReview.GsGCAllOpen.MainView("gvAll")
	gui.FrmOrderReview.progressBar1.Value(100)
	gui.FrmOrderReview.progressBar1.Visible(false)
	'gui.FrmOrderReview.lblStatus.Visible(false)

	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGVAll.End

Program.Sub.cmdRefresh_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CallSub(loaddtall)
	F.Intrinsic.Control.CallSub(Deserialize)
	
	
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdRefresh_Click.End

Program.Sub.GsGCAllOpen_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	v.Local.sSQL.Declare
	v.Local.sRet.Declare
	v.Local.sJob.Declare
	V.Local.sSO.Declare
	V.Local.sSOLine.Declare
	V.Local.sWO.Declare
	V.Local.sSuffix.Declare
	V.Local.sPO.Declare
	V.Local.sPOLine.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sParams.Declare
	v.Local.sShortRet.declare
	v.Local.sLinkID.Declare
	v.Local.sMsg.Declare
	v.Local.sGSSPart.Declare
	v.Local.sPartRev.Declare
	
	V.Local.iRet.Declare
	v.Local.iPID.Declare
	v.Local.bEdit.Declare
	V.Local.bRel.Declare
	v.Local.lRet.Declare
	v.Local.iRefID.Declare
	v.Local.iLinkID.Declare
	
	F.Global.Security.CheckUserAccessIPM(136,2,v.Global.bShipOEPermission)	
	F.Global.Security.CheckUserAccessIPM(661,2,v.Global.bShipSHIPPermission)
	
	F.Intrinsic.Control.SelectCase(V.Args.column)
			
		F.Intrinsic.Control.CaseAny("Released","RELEASED")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","WO",V.Args.RowIndex,V.Local.sJob)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SUFFIX",V.Args.RowIndex,V.Local.sSuffix)
			F.Intrinsic.Control.If(V.Args.CellValue,=,"False")
				F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_RELEASED = 'Y', DATE_RELEASED = '{0}' WHERE JOB = '{1}' AND SUFFIX = '{2}';",V.Ambient.Date.FormatMMDDYY,V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
				Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName("gvAll","RELEASED",V.Args.RowIndex,True)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_RELEASED = '', DATE_RELEASED = '000000' WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
				Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName("gvAll","RELEASED",V.Args.RowIndex,False)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.CaseAny("Printed","PRINTED","Print","PRINT")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","WO",V.Args.RowIndex,v.Local.sJob)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SUFFIX",V.Args.RowIndex,v.Local.sSuffix)
			'F.Intrinsic.Control.If(V.Args.CellValue,=,"False")
				'Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName("gvAll","PRINTED",V.Args.RowIndex,true)
				f.Intrinsic.Control.If(v.Local.sJob.Trim,<>,"")
					F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_PRTD = 'Y' WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
					F.ODBC.Connection!con.Execute(V.Local.sSQL)
					F.Intrinsic.String.Build("{0}!*!{1}!*!1811",V.Local.sJob,V.Local.sSuffix,V.Local.sParams)
					F.Global.General.CallWrapperSync(900100,V.Local.sParams)
				f.Intrinsic.Control.Else
					f.Intrinsic.UI.Msgbox("No work order for the selected line")
				f.Intrinsic.Control.EndIf
'			F.Intrinsic.Control.Else
'				Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName("gvAll","PRINTED",V.Args.RowIndex,false)
'				F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_PRTD = '' WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
'				F.ODBC.Connection!con.Execute(V.Local.sSQL)
'			F.Intrinsic.Control.EndIf
			
		f.Intrinsic.Control.caseany("PrtDocCntrl","PRTDOCCONTROL")
			V.Local.sPart.Set(V.DataTable.dtAll(V.Args.RowIndex).GSSPart!FieldValTRIM)
			f.Global.DocumentControl.GetLinkID(v.Local.sPart.Trim,30,v.Local.iRefID)
			f.Intrinsic.Control.If(v.Local.irefid,=,-1)
				F.ODBC.Connection!con.ExecuteAndReturn("SELECT MAX(LINK_ID) AS 'LinkID' FROM LINK_DATA",v.Local.sLinkID)
				f.Intrinsic.Math.ConvertToLong(v.Local.sLinkID,v.Local.iLinkID)
				f.Intrinsic.Math.Add(v.Local.iLinkID,1,v.Local.iLinkID)
				f.Intrinsic.string.LPad(v.Local.iLinkID,"0",9,v.Local.sLinkID)
				'f.Intrinsic.String.Build("INSERT INTO LINK_DATA (LINK_ID,TYPE,ID) VALUES('{0}','{1}','{2}')",v.Local.sLinkID,"00030",v.Local.spart,v.Local.ssql)
				'f.ODBC.Connection!con.execute(v.Local.ssql)
				V.Local.iRefID.Set(v.Local.iLinkID)
				F.Global.DocumentControl.CreateReference(V.Local.sPart,"00030",V.Local.iRefID)
			f.Intrinsic.Control.EndIf
			F.Global.DocumentControl.Invoke(V.Local.sPart,30,"(Inventory Master)",V.Local.iPID)
			
		f.Intrinsic.Control.caseany("JobDocCntrl","JOBDOCCONTROL")
			V.Local.sJob.Set(V.DataTable.dtAll(V.Args.RowIndex).JS!FieldValTRIM)
			f.Intrinsic.Control.If(v.Local.sJob.Trim,=,"")
				f.Intrinsic.UI.Msgbox("Work Order not created for this line.")
			f.Intrinsic.Control.Else
				f.Global.DocumentControl.GetLinkID(v.Local.sJob.Trim,30,v.Local.iRefID)
				f.Intrinsic.Control.If(v.Local.irefid,=,-1)
					F.ODBC.Connection!con.ExecuteAndReturn("SELECT MAX(LINK_ID) AS 'LinkID' FROM LINK_DATA",v.Local.sLinkID)
					f.Intrinsic.Math.ConvertToLong(v.Local.sLinkID,v.Local.iLinkID)
					f.Intrinsic.Math.Add(v.Local.iLinkID,1,v.Local.iLinkID)
					f.Intrinsic.string.LPad(v.Local.iLinkID,"0",9,v.Local.sLinkID)
					'f.Intrinsic.String.Build("INSERT INTO LINK_DATA (LINK_ID,TYPE,ID) VALUES('{0}','{1}','{2}')",v.Local.sLinkID,"00020",v.Local.spart,v.Local.ssql)
					'f.ODBC.Connection!con.execute(v.Local.ssql)
					V.Local.iRefID.Set(v.Local.iLinkID)
					F.Global.DocumentControl.CreateReference(V.Local.sJob,"00020",V.Local.iRefID)
				f.Intrinsic.Control.EndIf
				F.Global.DocumentControl.Invoke(V.Local.sJob,20,"(Job Master)",V.Local.iPID)
			f.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.CaseAny("SO","SOLINE")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SO",V.Args.RowIndex,V.Local.sSO)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SOLINE",V.Args.RowIndex,V.Local.sSOLINE)
			F.Intrinsic.Control.If(V.Local.sSO,<>,"")	
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optEdit.Value,=,True,"OR",V.Screen.FrmOrderReview!optIssue.Value,=,True,V.Screen.FrmOrderReview!optWipToFG.Value,=,True)				
					Function.Global.Security.CheckUserAccessIPM(132,1,v.Local.bEdit)
					f.Intrinsic.Control.If(v.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sSO,"O","*!*ZDR*!*",V.Local.sParams)
						F.Global.General.CallWrapperAsync(200000,V.Local.sParams)
					f.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sSO,"V","*!*ZDR*!*",V.Local.sParams)
						F.Global.General.CallWrapperAsync(200000,V.Local.sParams)
					f.Intrinsic.Control.EndIf
				f.Intrinsic.Control.ElseIf(v.Screen.FrmOrderReview!optShip.Value,=,True)
					f.Intrinsic.Control.If(v.Global.bShipOEPermission,=,True,or,v.Global.bShipSHIPPermission,=,True)
						Gui.FrmOrderReview.GsGCAllOpen.Enabled(False)
						F.Global.Callwrapper.New("Ship","Sales.NewShipments")
						F.Global.Callwrapper.SetProperty("Ship","OrderNumber",V.Local.sSO)
						F.Global.Callwrapper.SetProperty("Ship","OrderLine",V.Local.sSOLine)
						F.Global.CallWrapper.Run("Ship")
						Gui.FrmOrderReview.GsGCAllOpen.Enabled(True)
					f.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sSO,"V","*!*ZDR*!*",V.Local.sParams)
					F.Global.General.CallWrapperAsync(200000,V.Local.sParams)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("WO","Suffix","SUFFIX")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","WO",V.Args.RowIndex,v.Local.sWO)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","Suffix",V.Args.RowIndex,V.Local.sSuffix)
			F.Intrinsic.Control.If(V.Local.sWO,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optEdit.Value,=,True)
					Function.Global.Security.CheckUserAccessIPM(527,1,v.Local.bEdit)
					f.Intrinsic.Control.If(v.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sWO,V.Local.sSuffix,"O",V.Local.sParams)
						F.Global.General.CallWrapperAsync(2009,V.Local.sParams)
					f.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs("7",V.Local.sWO,V.Local.sSuffix,"A",V.Local.sParams)
						F.Global.General.CallWrapperAsync(450000,V.Local.sParams)
					f.Intrinsic.Control.EndIf					
				F.Intrinsic.Control.ElseIf(V.Screen.FrmOrderReview!optIssue.Value,=,True)								
					F.Intrinsic.String.Build("{0}!*!{1}!*! !*! !*! !*! !*! ",V.Local.sWO,V.Local.sSuffix,V.Local.sParams)
					F.Global.General.CallWrapperSync(450150,V.Local.sParams)
					F.Intrinsic.Control.SelectCase(V.Global.iPrintAudit)
						F.Intrinsic.Control.Case(1)
							F.Global.General.CallWrapperSync(50,"JB0057")
						F.Intrinsic.Control.Case(2)
							'Do Not Print
						F.Intrinsic.Control.Case(3)
							'F.Intrinsic.UI.Msgbox("Print Audit Trail?","Print",4,V.Local.iRet)
							'F.Intrinsic.Control.If(V.Local.iRet,=,6)
								F.Global.General.CallWrapperSync(50,"JB0057")
							'F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndSelect
				F.Intrinsic.Control.ElseIf(V.Screen.FrmOrderReview!optWiptoFG.Value,=,True)
					F.Intrinsic.String.Build("{0}!*!{1}!*!{2}!*!OS!*!!*!!*!!*!!*!!*!!*!{3}!*!{4}!*!16!*!03!*!02!*!!*!!*!!*!!*!!*!!*!!*!!*!!*!",V.Caller.CompanyCode,V.Caller.Terminal,V.Caller.Caller,V.Local.sWO,V.Local.sSuffix,V.Local.sParams)
					F.Global.General.CallWrapperSync(2003,V.Local.sParams)
					F.Intrinsic.Control.SelectCase(V.Global.iPrintAudit)
						F.Intrinsic.Control.Case(1)
							F.Global.General.CallWrapperSync(50,"JB0057/C")
						F.Intrinsic.Control.Case(2)
							'Do Not Print
						F.Intrinsic.Control.Case(3)
							F.Global.General.CallWrapperSync(50,"JB0057/C")
					F.Intrinsic.Control.EndSelect
				F.Intrinsic.Control.Else
					F.Intrinsic.String.ConcatCallWrapperArgs("7",V.Local.sWO,V.Local.sSuffix,"A",V.Local.sParams)
					F.Global.General.CallWrapperAsync(450000,V.Local.sParams)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
'		F.Intrinsic.Control.CaseAny("PO","POLine")
'			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","PO",v.Args.RowIndex,v.Local.sPO)
'			F.Intrinsic.Control.If(V.Local.sPO,<>,"")
'				F.Intrinsic.Control.If(v.Screen.FrmOrderReview!optEdit.Value,=,True,"OR",v.Screen.FrmOrderReview!optIssue.Value,=,True,v.Screen.FrmOrderReview!optWipToFG.Value,=,True)
'					Function.Global.Security.CheckUserAccessIPM(265,1,v.Local.bEdit)
'					f.Intrinsic.Control.If(v.Local.bEdit)
'						F.Intrinsic.String.ConcatCallWrapperArgs("O",V.Local.sPO,"",V.Local.sParams)
'					f.Intrinsic.Control.Else
'						F.Intrinsic.String.ConcatCallWrapperArgs("V",V.Local.sPO,"",V.Local.sParams)
'					f.Intrinsic.Control.EndIf					
'				F.Intrinsic.Control.Else
'					F.Intrinsic.String.ConcatCallWrapperArgs("V",V.Local.sPO,"",V.Local.sParams)
'				F.Intrinsic.Control.EndIf
'				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
'			F.Intrinsic.Control.EndIf				
		
		F.Intrinsic.Control.CaseAny("SOPart","SOLoc")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","ACTPART",V.Args.RowIndex,v.Local.sPart.Trim)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","ACTREV",V.Args.RowIndex,v.Local.sPartRev.Trim)
			f.Intrinsic.Control.If(v.Global.bLongPart)
				F.Global.Inventory.GetGSSPart(V.Local.sPart.Trim,v.Local.sPartRev.Trim,V.Local.sShortRet)
			f.Intrinsic.Control.Else
				v.Local.sShortRet.Set(v.Local.sPart.Trim)
			f.Intrinsic.Control.EndIf
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SOLoc",V.Args.RowIndex,v.Local.sLoc)
			F.Intrinsic.Control.If(v.Local.sPart,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optView.Value,=,True)				
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sShortRet.Trim,V.Local.sLoc,"O",V.Local.sParams)
				F.Intrinsic.Control.Else
					Function.Global.Security.CheckUserAccessIPM(371,0,v.Local.bEdit)
					f.Intrinsic.Control.If(v.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sShortRet.Trim,V.Local.sLoc,"M",V.Local.sParams)
					f.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sShortRet.Trim,V.Local.sLoc,"O",V.Local.sParams)
					f.Intrinsic.Control.EndIf					
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.CaseAny("WOPart","WOLoc")			
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","GSSPart",V.Args.RowIndex,v.Local.sPart)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","WOLoc",V.Args.RowIndex,v.Local.sLoc)
			F.Intrinsic.Control.If(v.Local.sPart,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optView.Value,=,True)
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"O",V.Local.sParams)
				F.Intrinsic.Control.Else
					Function.Global.Security.CheckUserAccessIPM(371,0,v.Local.bEdit)
					f.Intrinsic.Control.If(v.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"M",V.Local.sParams)
					f.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"O",V.Local.sParams)
					f.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf
	
		F.Intrinsic.Control.CaseAny("POPart","POLoc")			
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","GSSPart",V.Args.RowIndex,v.Local.sPart)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","POLoc",V.Args.RowIndex,v.Local.sLoc)
			F.Intrinsic.Control.If(v.Local.sPart,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optView.Value,=,True)					
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"O",V.Local.sParams)
				F.Intrinsic.Control.Else
					Function.Global.Security.CheckUserAccessIPM(371,0,v.Local.bEdit)
					f.Intrinsic.Control.If(v.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"M",V.Local.sParams)
					f.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"O",V.Local.sParams)
					f.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf
'		'Need to figure out this review column function....
'		f.Intrinsic.Control.Case("Review")
'			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","GSSPart",V.Args.RowIndex,v.Local.sPart)
'			f.Intrinsic.String.Build("SELECT * FROM V_BOM_MSTR WHERE PARENT='{0}'",v.Local.sPart.Trim,v.Local.sSQL)
'			f.ODBC.Connection!con.executeandreturn(v.Local.sSQL,v.Local.sRet)
'			f.Intrinsic.Control.If(v.Local.sRet.Trim,<>,"")
'				'f.Global.General.CallWrapperAsync(50,"BM0020GI/O")
'			F.Intrinsic.Control.Else
'				F.Intrinsic.String.ConcatCallWrapperArgs("O",v.Local.sPart,V.Local.sParams)
'				f.Global.General.CallWrapperAsync(400000,v.Local.sParams)
'			f.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.CaseAny("Flex_Proc","FLEX_PROC")
			F.Intrinsic.Control.If(V.Global.bFlexProcEdit,=,True,and,V.DataTable.dtAll(V.Args.RowIndex).WO!FieldValString,<>,"")
				F.Data.DataTable.SetValue("dtAll",V.Args.RowIndex,"FLEX_PROC",V.Args.CellValue.Not)
				
				F.Data.DataTable.Create("dtSave",False)
				F.Data.DataTable.AddColumn("dtSave","Job","String")
				F.Data.DataTable.AddColumn("dtSave","Suffix","String")
				F.Intrinsic.Control.If(V.DataTable.dtAll(V.Args.RowIndex).Flex_No!FieldValString,<>,"")
					F.Data.DataTable.AddColumn("dtSave","Flex_Sched","String")
				F.Intrinsic.Control.EndIf
				F.Data.DataTable.AddColumn("dtSave","Processed","Boolean")
				F.Intrinsic.Control.If(V.DataTable.dtAll(V.Args.RowIndex).Flex_No!FieldValString,<>,"")
					F.Data.DataTable.AddRow("dtSave","Job",V.DataTable.dtAll(V.Args.RowIndex).WO!FieldVal,"Suffix",V.DataTable.dtAll(V.Args.RowIndex).Suffix!FieldVal,"Flex_Sched",V.DataTable.dtAll(V.Args.RowIndex).Flex_No!FieldVal,"Processed",V.Args.CellValue.Not)
				F.Intrinsic.Control.Else
					F.Data.DataTable.AddRow("dtSave","Job",V.DataTable.dtAll(V.Args.RowIndex).WO!FieldVal,"Suffix",V.DataTable.dtAll(V.Args.RowIndex).Suffix!FieldVal,"Processed",V.Args.CellValue.Not)
				F.Intrinsic.Control.EndIf
				
				F.ODBC.Connection!SAVEcon.OpenCompanyConnection
				F.Data.DataTable.SaveToDB("dtSave","SAVEcon","MOB_FLEX_HIST","JOB*!*SUFFIX",256)
				F.ODBC.Connection!SAVEcon.Close
				
				F.Data.DataTable.Close("dtSave")
			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllOpen_RowCellClick.End

Program.Sub.GsGCAllOpen_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sOrder.Declare
	V.Local.sSOLine.Declare
	V.Local.sLine.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare
	v.Local.sJob.Declare
	v.Local.sSuf.Declare
	V.Local.sParams.Declare
	v.Local.sDate.Declare
	v.Local.sDateLong.Declare
	v.Local.sDateUS.Declare
	v.Local.sdatesched.Declare
	
	v.Local.dDateSched.Declare
	V.Local.dDate.Declare
	
	Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SO",V.Args.RowIndex,V.Local.sOrder)
	Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SOLine",V.Args.RowIndex,V.Local.sLine)
	F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sSOLine)
	
	'f.Intrinsic.Debug.ShowCallerInfo
	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.CaseAny("SODueDate","SODUEDATE")
			
			'GSS CI Arturo Almaguer modification 7/11/22
			F.Intrinsic.Control.If(V.Args.Value.String,=,"")
				'Null Date
				f.Data.DataTable.SetValue("dtAll",v.Args.rowindex,"SODueDate","1/1/1900")
			F.Intrinsic.Control.EndIf
			'Select the row
			'f.Data.DataTable.SetValue("dtAll",v.Args.rowindex,"ScheduleWO",true)
			'''''''''''''''''''''''''''''''''''''''''''''''''''''''''
			
			'Update line item due date
			v.Local.ddate.set(V.DataTable.dtAll(v.args.rowindex).SODueDate!FieldValString)
			f.Intrinsic.String.Format(v.Local.ddate,"dd/mm/yyyy",v.Local.sdatesched)
			f.Intrinsic.String.Format(v.Local.ddate,"MMDDYY",v.Local.sdate)
			f.Intrinsic.String.Format(v.Local.ddate,"YYYYMMDD",v.Local.SDATELong)
			F.Intrinsic.String.Format(V.Local.ddate,"DD/MM/YY",V.Local.SDATEUS)
			F.Intrinsic.String.Concat("UPDATE ORDER_LINES SET DATE_ITEM_PROM='",v.Local.SDATELong,"', ITEM_PROMISE_DT='",v.Local.sdate,"' WHERE Order_No='",v.DataTable.dtAll(v.Args.rowindex).SO!fieldvaltrim,"' and Record_No='",v.DataTable.dtAll(v.args.rowindex).SOLine!fieldvaltrim,"0'",V.Local.sSQL)
			F.ODBC.Connection!con.Execute(v.Local.ssql)
						
			'Update line item due date
			v.Local.sJob.Set(v.DataTable.dtAll(v.Args.rowindex).WO!FIELDVALTRIM)
			v.Local.sSuf.Set(v.DataTable.dtAll(v.Args.rowindex).SUFFIX!FIELDVALTRIM)
			f.Intrinsic.String.Format(v.Local.ddate,"MMDDYY",v.Local.sdate)
			F.Intrinsic.String.Concat("UPDATE JOB_HEADER SET DATE_DUE='",v.Local.sdate,"' WHERE JOB='",v.Local.sJob,"' and SUFFIX='",V.Local.sSuf,"'",V.Local.sSQL)
			F.ODBC.Connection!con.Execute(v.Local.ssql)
			
		F.Intrinsic.Control.CaseAny("MUST_DLVR_BY_DATE")
			
			F.Intrinsic.Control.If(V.Args.Value.String,=,"")
				'Null Date
				f.Data.DataTable.SetValue("dtAll",v.Args.rowindex,"MUST_DLVR_BY_DATE","1/1/1900")
			F.Intrinsic.Control.EndIf
			'Select the row
			'f.Data.DataTable.SetValue("dtAll",v.Args.rowindex,"ScheduleWO",true)
			'''''''''''''''''''''''''''''''''''''''''''''''''''''''''
			
			'Update line item due date
			v.Local.ddate.set(V.DataTable.dtAll(v.args.rowindex).MUST_DLVR_BY_DATE!FieldValString)
			f.Intrinsic.String.Format(v.Local.ddate,"dd/mm/yyyy",v.Local.sdatesched)
			f.Intrinsic.String.Format(v.Local.ddate,"MMDDYY",v.Local.sdate)
			f.Intrinsic.String.Format(v.Local.ddate,"YYYYMMDD",v.Local.SDATELong)
			F.Intrinsic.String.Format(V.Local.ddate,"DD/MM/YY",V.Local.SDATEUS)
			F.Intrinsic.String.Concat("UPDATE ORDER_LINES SET MUST_DLVR_BY_DATE='",v.Local.SDATELong,"' WHERE Order_No='",v.DataTable.dtAll(v.Args.rowindex).SO!fieldvaltrim,"' and Record_No='",v.DataTable.dtAll(v.args.rowindex).SOLine!fieldvaltrim,"0'",V.Local.sSQL)
			F.ODBC.Connection!con.Execute(v.Local.ssql)
						
			'Update line item due date
'			v.Local.sJob.Set(v.DataTable.dtAll(v.Args.rowindex).WO!FIELDVALTRIM)
'			v.Local.sSuf.Set(v.DataTable.dtAll(v.Args.rowindex).SUFFIX!FIELDVALTRIM)
'			f.Intrinsic.String.Format(v.Local.ddate,"MMDDYY",v.Local.sdate)
'			F.Intrinsic.String.Concat("UPDATE JOB_HEADER SET DATE_DUE='",v.Local.sdate,"' WHERE JOB='",v.Local.sJob,"' and SUFFIX='",V.Local.sSuf,"'",V.Local.sSQL)
'			F.ODBC.Connection!con.Execute(v.Local.ssql)
			
			
		F.Intrinsic.Control.CaseAny("NOTES","Notes")
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM GAB_4167_SO_NOTES WHERE SO = '{0}' AND SOLINE = '{1}';",V.Local.sOrder,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO GAB_4167_SO_NOTES(SO,SOLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE GAB_4167_SO_NOTES SET NOTES = '{0}' WHERE SO = '{1}' AND SOLINE = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Args.Value,"GV","gvAll","SO_Note","NOTES")
		
		F.Intrinsic.Control.CaseAny("USER_1","User_1")
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,User_1) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET User_1 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAll","SO_Note","User_1")
			
			F.Intrinsic.Control.CaseAny("PO","Po")
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,User_2) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET User_2 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAll","SO_Note","PO")
			
			F.Intrinsic.Control.CaseAny("POLINE","POLine")
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,User_3) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET User_3 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAll","SO_Note","POLine")
			
		F.Intrinsic.Control.CaseAny("USER_4","User_4")
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,USER_4) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_4 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAll","SO_Note","USER_4")
	
		F.Intrinsic.Control.CaseAny("USER_5","User_5")
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_5 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV","gvAll","SO_Note","USER_5")
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllOpen_CellValueChanged.End

Program.Sub.CheckTable.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bExists.Declare

	F.ODBC.Connection!con.TableExists("GAB_4167_SO_NOTES",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,!=,true)
		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_4167_SO_NOTES(SO CHAR(7),SOLINE CHAR(3),NOTES LONGVARCHAR);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4167_SO_NOTES01 USING 1 ON GAB_4167_SO_NOTES(SO);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4167_SO_NOTES02 USING 2 ON GAB_4167_SO_NOTES(SOLINE);")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckTable.End

Program.Sub.CheckNote.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSO.Declare
	V.Local.sLine.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare

	F.Intrinsic.Control.If(V.Args.SO_Note,=,"NOTES")
'		Gui.FrmOrderReview.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
'		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
'		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
'			Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SO",V.Local.iCnt,V.Local.sSO)
'			Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SOLine",V.Local.iCnt,V.Local.sLine)
'			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
'			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
'				Gui.FrmOrderReview.GsGCPastDue.SetCellValueByColumnName("gvPastDue","NOTES",V.Local.iCnt,V.Args.Note)
'			F.Intrinsic.Control.EndIf
'		F.Intrinsic.Control.Next(V.Local.iCnt)

		Gui.FrmOrderReview.GsGCAllOpen.GetRowCount("gvAll",V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SO",V.Local.iCnt,V.Local.sSO)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SOLine",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName("gvAll","NOTES",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.Control.ElseIf(V.Args.SO_Note,=,"USER_4")
'		F.Intrinsic.Control.If(V.Args.GV,=,"gvAll")
'			Gui.FrmOrderReview.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
'			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
'			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
'				Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SO",V.Local.iCnt,V.Local.sSO)
'				Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SOLine",V.Local.iCnt,V.Local.sLine)
'				F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
'				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
'					Gui.FrmOrderReview.GsGCPastDue.SetCellValueByColumnName("gvPastDue","USER_4",V.Local.iCnt,V.Args.Note)
'				F.Intrinsic.Control.EndIf
'			F.Intrinsic.Control.Next(V.Local.iCnt)
'		F.Intrinsic.Control.Else
			Gui.FrmOrderReview.GsGCAllOpen.GetRowCount("gvAll",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SO",V.Local.iCnt,V.Local.sSO)
				Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SOLine",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName("gvAll","USER_4",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
'		F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.ElseIf(V.Args.SO_Note,=,"USER_5")
'		F.Intrinsic.Control.If(V.Args.GV,=,"gvAll")
'			Gui.FrmOrderReview.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
'			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
'			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
'				Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SO",V.Local.iCnt,V.Local.sSO)
'				Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SOLine",V.Local.iCnt,V.Local.sLine)
'				F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
'				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
'					Gui.FrmOrderReview.GsGCPastDue.SetCellValueByColumnName("gvPastDue","USER_5",V.Local.iCnt,V.Args.Note)
'				F.Intrinsic.Control.EndIf
'			F.Intrinsic.Control.Next(V.Local.iCnt)
'		F.Intrinsic.Control.Else
			Gui.FrmOrderReview.GsGCAllOpen.GetRowCount("gvAll",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SO",V.Local.iCnt,V.Local.sSO)
				Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","SOLine",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName("gvAll","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
'		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckNote.End

Program.Sub.CheckPermissions.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	v.Local.bEditInventory.Declare
	v.Local.bEditWO.Declare
	v.Local.bEditPO.Declare
	v.Local.bEditSO.Declare
	V.Local.bIssueGrp.Declare
	V.Local.bWiptoFG.Declare	
	V.Local.bChecked.Declare
	V.Local.bNewSO.Declare
	V.Local.bNewWO.Declare
	V.Local.bAutoWO.Declare
	V.Local.bOpenBOM.Declare
	V.Local.bOpenInv.Declare
	V.Local.bOpenRout.Declare
	
	'Check if any of the menu items have edit permissions
	F.Global.Security.CheckUserAccessIPM(371,0,v.Local.bEditInventory)
	F.Global.Security.CheckUserAccessIPM(527,1,v.Local.bEditWO)
	F.Global.Security.CheckUserAccessIPM(527,2,v.Local.bNewWO)
	F.Global.Security.CheckUserAccessIPM(540,0,v.Local.bAutoWO)
	F.Global.Security.CheckUserAccessIPM(265,1,v.Local.bEditPO)
	F.Global.Security.CheckUserAccessIPM(132,1,v.Local.bEditSO)
	F.Global.Security.CheckUserAccessIPM(132,2,v.Local.bNewSO)
	F.Global.Security.CheckUserAccessIPM(467,1,v.Local.bOpenBOM)
	F.Global.Security.CheckUserAccessIPM(310,1,v.Local.bOpenInv)
	F.Global.Security.CheckUserAccessIPM(482,1,v.Local.bOpenRout)
	F.Global.Security.CheckUserAccessIPM(136,2,v.Global.bShipOEPermission)
	F.Global.Security.CheckUserAccessIPM(661,2,v.Global.bShipSHIPPermission)
	'Shop Floor Control > File > Generate Flex Schedule
	F.Global.Security.CheckUserAccessIPM(100048,0,v.Global.bFlexProcEdit)
	Gui.FrmOrderReview.optView.Value(True)
	
	F.Intrinsic.Control.If(V.Local.bEditInventory,=,True,or,v.Local.bEditWO,=,True,v.Local.bEditPO,=,True,v.Local.bEditSO,=,True)
		Gui.FrmOrderReview.optEdit.Enabled(True)	
		gui.FrmOrderReview.optEdit.Value(True)
	F.Intrinsic.Control.EndIf

	Function.Global.Security.CheckUserAccessIPM(533,0,v.Local.bIssueGrp)
	F.Intrinsic.Control.If(v.Local.bIssueGrp,=,True)
		Gui.FrmOrderReview.optIssue.Enabled(True)
	F.Intrinsic.Control.EndIf

	Function.Global.Security.CheckUserAccessIPM(544,0,v.Local.bWiptoFG)
	F.Intrinsic.Control.If(v.Local.bWiptoFG,=,True)
		Gui.FrmOrderReview.optWiptoFG.Enabled(True)
	F.Intrinsic.Control.EndIf
	
	'Ship Radio button
	F.Intrinsic.Control.If(V.Global.bShipOEPermission,=,True,OR,v.Global.bShipSHIPPermission,=,True)
		Gui.FrmOrderReview.optShip.Enabled(1)
		V.Global.bShip.Set(True)
		f.Intrinsic.Control.If(v.Local.bChecked,=,False)
			'Gui.FrmOrderReview.optShip.Value(True)
			v.Local.bChecked.Set(True)
		f.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		Gui.FrmOrderReview.optShip.Enabled(0)
		V.Global.bShip.Set(False)
		Gui.FrmOrderReview.optShip.Value(False)
		v.Local.bChecked.Set(False)
	F.Intrinsic.Control.EndIf
	
'	'ACC PERMS
	Gui.FrmOrderReview.acMenuItems.SetElementVisible("aceAutoWO",V.Local.bAutoWO)
	Gui.FrmOrderReview.acMenuItems.SetElementVisible("aceBOM",V.Local.bOpenBOM)
	Gui.FrmOrderReview.acMenuItems.SetElementVisible("acePart",V.Local.bOpenInv)
	Gui.FrmOrderReview.acMenuItems.SetElementVisible("aceRouter",V.Local.bOpenRout)
'	Gui.FrmOrderReview.acMenuItems.SetElementVisible("aceOpenDocs",V.Local.bEditWO)
	Gui.FrmOrderReview.acMenuItems.SetElementVisible("aceNewSO",V.Local.bNewSO)
	Gui.FrmOrderReview.acMenuItems.SetElementVisible("aceNewWO",V.Local.bNewWO)
'	Gui.FrmOrderReview.acMenuItems.SetElementVisible("acePrintWODocs",V.Local.bEditWO)
	Gui.FrmOrderReview.acMenuItems.SetElementVisible("aceReschedule",V.Local.bEditWO)

'	F.Intrinsic.Control.If(V.Local.bWiptoFG,=,True,and,V.Local.bIssueGrp,=,True)
'		
'	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckPermissions.End

Program.Sub.SetContextMenus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare	
	v.Local.bEditSO.Declare	
	v.Local.bEditWO.Declare
	
	Gui.FrmOrderReview..ContextMenuCreate("ctxAll")
	Gui.FrmOrderReview.GsGCAllOpen.ContextMenuAttach("ctxAll")
	
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","ResetColumns",0,"Reset Columns")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","ResetColumns","MenuClickResetColumns")

	'GSS CI Arturo Almaguer modification 7/11/22
	'Adding new context menus
	GUI.FrmOrderReview..ContextMenuAddItem("ctxAll","SelectAll",0,"Select All")
	GUI.FrmOrderReview..ContextMenuAddItem("ctxAll","UnselectAll",0,"Unselect All")
	GUI.FrmOrderReview..ContextMenuAddItem("ctxAll","UnselectVisible",0,"Unselect Visible")
	GUI.FrmOrderReview..ContextMenuAddItem("ctxAll","SODueDateUpdate",0,"Mass Update SO Due Date")
	
	GUI.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","SelectAll","MenuClickSA")
	GUI.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","UnselectAll","MenuClickUnselectAll")
	GUI.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","SODueDateUpdate","MenuClickMassUpdate")
	GUI.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","UnselectVisible","MenuClickSA")
	'''''''''''''''''''''''''''''''''''''''''''''''

'	Function.Global.Security.CheckUserAccessIPM(132,1,v.Local.bEditSO)
'	f.Intrinsic.Control.If(v.Local.bEditSO)
'		Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","NewSO",0,"New SO")
'		Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","NewSO","MenuClickNewSO")
'		Gui.FrmOrderReview..ContextMenuAddItem("ctxPastDue","NewSO",0,"New SO")
'		Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxPastDue","NewSO","MenuClickNewSO")
'	f.Intrinsic.Control.EndIf	
'	
'	Function.Global.Security.CheckUserAccessIPM(527,1,v.Local.bEditWO)
'	f.Intrinsic.Control.If(v.Local.bEditWO)
'		Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","NewWO",0,"New WO")
'		Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","NewWO","MenuClickNewWO")
'		Gui.FrmOrderReview..ContextMenuAddItem("ctxPastDue","NewWO",0,"New WO")
'		Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxPastDue","NewWO","MenuClickNewWO")		
'	f.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetContextMenus.End

Program.Sub.MenuClickQuickInvOut.Start
f.Intrinsic.Control.Try
	v.Local.sMessage.Declare
	v.Local.sOrder.Declare
	v.Local.i.Declare
	
	f.Intrinsic.Control.If(v.DataTable.dtOrders.Exists)
		f.Data.DataTable.Close("dtOrders")
	f.Intrinsic.Control.EndIf	
	
	f.Data.DataTable.Create("dtOrders","true")
	f.Data.DataTable.AddColumn("dtOrders","SO","String")
	
	'Create the message
	f.Intrinsic.String.Concat("Invoicing for Sales Orders: ",v.Ambient.NewLine,v.Local.sMessage)
	f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtAll.RowCount--,1)
		f.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).ScheduleWO!fieldval,=,"True")
			v.Local.sOrder.Set(v.DataTable.dtAll(v.Local.i).SO!fieldvaltrim)
			f.Intrinsic.String.Concat(v.Local.sMessage," ",v.Local.sOrder," ",v.Ambient.NewLine,V.Local.sMessage)
			f.Data.DataTable.AddRow("dtOrders","SO",v.Local.sOrder)
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Next(v.Local.i)
	
	'Run select orders to invoice one shot
	
	'Are you sure? message
	

	
f.Intrinsic.Control.Catch

f.Intrinsic.Control.EndTry
Program.Sub.MenuClickQuickInvOut.End

Program.Sub.MenuClickRefresh.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	gui.FrmOrderReview.GsGCAllOpen.enabled(false)
	F.Intrinsic.Control.CallSub(cmdRefresh_Click)
	gui.FrmOrderReview.GsGCAllOpen.enabled(true)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickRefresh.End

Program.Sub.MenuClickExport.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare
	V.Local.sControl.Declare
	
	V.Local.sControl.Set("GsGCAllOpen")

	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
	F.Intrinsic.Control.If(V.Local.bExcel)
		F.Intrinsic.String.Build("{0}\GAB_5219_{1}_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sControl,V.Local.sFileExport)
		F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
		F.Intrinsic.Control.If(V.Local.bFileLocked)
			F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
		F.Intrinsic.Control.Else
			Gui.FrmOrderReview.[V.Local.sControl].Export(V.Local.sFileExport,"xlsx")
			F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}\GAB_5219_{1}_Export.csv",V.Caller.LocalGssTempDir,V.Local.sControl,V.Local.sFileExport)
		F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
		F.Intrinsic.Control.If(V.Local.bFileLocked)
			F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
		F.Intrinsic.Control.Else
			Gui.FrmOrderReview.[V.Local.sControl].Export(V.Local.sFileExport,"csv")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickExport.End

Program.Sub.MenuClickResetColumns.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXALL")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALL",5219,3001,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
'		F.Intrinsic.Control.Case("CTXPASTDUE")
'			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",5219,2000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
	F.Intrinsic.Control.EndSelect
	
	V.Global.bLoadData.Set(False)
	F.Intrinsic.Control.CallSub(cmdRefresh_Click)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickResetColumns.End

Program.Sub.MenuClickNewSO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare	
	V.Local.iRowCnt.Declare
	V.Local.iRowCnt2.Declare
	
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_ORDER_HEADER;",V.Local.iRowCnt)
				
	'gui.FrmOrderReview.tabSO.Enabled(False)
	gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	F.Global.General.CallWrapperSync(200000,"*!*ZDR*!*!*!N!*!*!*ZDR*!*")	
	'gui.FrmOrderReview.tabSO.Enabled(True)
	gui.FrmOrderReview.GsGCAllOpen.enabled(True)

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_ORDER_HEADER;",V.Local.iRowCnt2)

	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)	
	F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickNewSO.End

Program.Sub.MenuClickNewWO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRowCnt.Declare
	V.Local.iRowCnt2.Declare
	V.Local.iPID.Declare
	V.Local.bPID.Declare
	
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM JOB_HEADER;",V.Local.iRowCnt)

	'gui.FrmOrderReview.tabSO.Enabled(False)
	gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	F.Global.General.LaunchMenuTask(527,2,V.Local.iPID)
	F.Intrinsic.Task.PIDRunning(V.Local.iPID,V.Local.bPID)
	F.Intrinsic.Control.DoUntil(V.Local.bPID,=,False)
	F.Intrinsic.UI.SleepMS(10)
	F.Intrinsic.Task.PIDRunning(V.Local.iPID,V.Local.bPID)
	F.Intrinsic.Control.Loop
	gui.FrmOrderReview.GsGCAllOpen.enabled(True)
	'gui.FrmOrderReview.tabSO.Enabled(True)

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM JOB_HEADER;",V.Local.iRowCnt2)

	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickNewWO.End

Program.Sub.picGSSLogo_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://www.globalshopsolutions.com/login-customer","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.picGSSLogo_DblClick.End

Program.Sub.Serialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare

	'gvAll	
	Gui.FrmOrderReview.GsGCAllOpen.Serialize("gvAll",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALL",5219,3001,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'gvPastDue
'	Gui.FrmOrderReview.GsGCPastDue.Serialize("gvPastDue",V.Local.sSerialize)
'	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",5219,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
	F.Intrinsic.Control.Try
		V.Local.sError.Declare
		
		V.Local.sSerialize.Declare
		
		'Delete old registry records
'		F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALL",5219,0,5,"",V.Local.sSerialize)
'		F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
'			F.ODBC.Connection!common.OpenConnection(V.Ambient.Ccon,V.Ambient.Cuser,V.Ambient.Cpass)
'			F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 5219 And Seq < 1000;")
'			F.ODBC.Connection!common.Close
'		F.Intrinsic.Control.EndIf

		'gvAll
		F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALL",5219,3001,6,"",V.Local.sSerialize)
		F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
			Gui.FrmOrderReview.GsGCAllOpen.Deserialize(V.Local.sSerialize)
		F.Intrinsic.Control.EndIf
		'gvPastDue
'		F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",5219,1000,6,"",V.Local.sSerialize)
'		F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
'			Gui.FrmOrderReview.GsGCPastDue.Deserialize(V.Local.sSerialize)
'		F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.cmdCreateWO_Click.Start
F.Intrinsic.Control.CallSub(cmdBWDSched_Click)
Program.Sub.cmdCreateWO_Click.End

Program.Sub.cmdOpenDoc_Click.Start
f.Intrinsic.Control.Try

	gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	v.Local.i.Declare(long)
	v.Local.j.Declare(long)
	v.Local.k.Declare(long)
	v.Local.ssql.Declare(string)
	v.Local.sjob.Declare(string)
	v.Local.sSuf.Declare(string)
	v.Local.sret.Declare(string)
	v.Local.sPart.Declare(string)
	v.Local.sMessage.Declare(string)
	v.Local.sShortRet.Declare(string)
	v.Local.sTemp.Declare(string)
	v.Local.iLinkID.Declare(long)
	v.Local.lRet.Declare(long)
	
	f.Intrinsic.Control.If(v.DataTable.dtPrint.Exists)
		f.Data.DataTable.Close("dtPrint")
	f.Intrinsic.Control.EndIf	
	
	f.Data.DataTable.Create("dtPrint","true")
	f.Data.DataTable.AddColumn("dtPrint","Part","String")
	f.Data.DataTable.AddColumn("dtPrint","Job","String")
	f.Data.DataTable.AddColumn("dtPrint","Suffix","String")
	
	'Verify if the user wants to do this.
	f.Intrinsic.String.Concat("Open Documents for: ",v.Ambient.NewLine,v.Local.sMessage)
	f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtAll.RowCount--,1)
		f.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).ScheduleWO!fieldval,=,"True")
			v.Local.spart.Set(v.DataTable.dtAll(v.Local.i).SOPart!fieldvaltrim)
			f.Intrinsic.String.Concat(v.Local.sMessage," ",v.DataTable.dtAll(v.Local.i).SOPart!fieldval," --- ",v.DataTable.dtAll(v.Local.i).Description!fieldval,v.Ambient.NewLine,V.Local.sMessage)
			f.Data.DataTable.AddRow("dtPrint","Part",v.Local.spart)
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Next(v.Local.i)
	
	'Reset i before continuing on
	v.Local.i.Set(0)
	f.Intrinsic.Control.If(v.DataTable.dtPrint.RowCount,<>,0)
		f.Intrinsic.UI.Msgbox(v.Local.sMessage,"Open Documents?",4,v.Local.lret)
	f.Intrinsic.Control.Else
		f.Intrinsic.UI.Msgbox("No valid lines selected.")
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.Control.If(v.Local.lret,=,6)
		f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtPrint.RowCount--,1)
			v.Local.spart.Set(v.DataTable.dtPrint(v.Local.i).Part!fieldvaltrim)		
			F.Global.Inventory.GetGSSPart(V.Local.sPart,"",V.Local.sShortRet)
			F.Global.DocumentControl.CreateReference(v.Local.sShortRet,30,V.Local.iLinkID)
			F.Intrinsic.Control.If(V.Local.iLinkID,>,0)
				'Grab the files
				F.Intrinsic.String.Build("SELECT * FROM ATG_DOC_ASSOC WHERE LINK_ID = {0}",v.Local.iLinkID,v.Local.ssql)
				f.Intrinsic.Control.If(v.DataTable.dtFiles.Exists)
					f.Data.DataTable.Close("dtFiles")
				f.Intrinsic.Control.EndIf
				f.Data.DataTable.CreateFromSQL("dtFiles",con,v.Local.ssql,true)
				
				f.Intrinsic.Control.If(v.DataTable.dtFiles.RowCount,<>,0)
					f.Intrinsic.Control.For(v.Local.k,0,v.DataTable.dtFiles.RowCount--,1)
						
						F.Intrinsic.String.Right(v.DataTable.dtFiles(v.Local.k).PATH!FieldvalTrim,1,V.Local.stemp)
						f.Intrinsic.Control.If(v.Local.sTemp,=,"\")
							F.Intrinsic.String.Concat(v.DataTable.dtFiles(v.Local.k).PATH!FieldvalTrim,v.DataTable.dtFiles(v.Local.k).FILE!FieldvalTrim,V.Local.stemp)
						f.Intrinsic.Control.Else
							F.Intrinsic.String.Concat(v.DataTable.dtFiles(v.Local.k).PATH!FieldvalTrim,"\",v.DataTable.dtFiles(v.Local.k).FILE!FieldvalTrim,V.Local.stemp)
						f.Intrinsic.Control.EndIf
						
						'If it cannot print a document, catch it
						f.Intrinsic.Control.Try
							F.Intrinsic.task.ShellExec(V.Caller.Handle,"OPEN",V.local.sTemp,"","",5)
						f.Intrinsic.Control.Catch
						f.Intrinsic.Control.EndTry
						f.Intrinsic.UI.SleepMS(3000)
					f.Intrinsic.Control.Next(v.Local.k)
				f.Intrinsic.Control.Else
					f.Intrinsic.String.Concat("No documents found for part: ",v.Local.sPart,v.Local.sMessage)
					f.Intrinsic.UI.Msgbox(v.Local.sMessage)
				f.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		f.Intrinsic.Control.Next(v.Local.i)
		
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	f.Intrinsic.Control.EndIf
	
	gui.FrmOrderReview.GsGCAllOpen.enabled(True)
f.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.Intrinsic.Control.CallSub(FrmOrderReview_UnLoad)
f.Intrinsic.Control.EndTry
Program.Sub.cmdOpenDoc_Click.End

Program.Sub.cmdPrintDoc_Click.Start
f.Intrinsic.Control.Try

	gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	v.Local.i.Declare(long)
	v.Local.j.Declare(long)
	v.Local.k.Declare(long)
	v.Local.ssql.Declare(string)
	v.Local.sjob.Declare(string)
	v.Local.sSuf.Declare(string)
	v.Local.sret.Declare(string)
	v.Local.sPart.Declare(string)
	v.Local.sMessage.Declare(string)
	v.Local.sShortRet.Declare(string)
	v.Local.sTemp.Declare(string)
	v.Local.iLinkID.Declare(long)
	v.Local.lRet.Declare(long)
	
	f.Intrinsic.Control.If(v.DataTable.dtPrint.Exists)
		f.Data.DataTable.Close("dtPrint")
	f.Intrinsic.Control.EndIf	
	
	f.Data.DataTable.Create("dtPrint","true")
	f.Data.DataTable.AddColumn("dtPrint","Part","String")
	f.Data.DataTable.AddColumn("dtPrint","Job","String")
	f.Data.DataTable.AddColumn("dtPrint","Suffix","String")
	
	'Verify if the user wants to do this.
	f.Intrinsic.String.Concat("Print Documents for: ",v.Ambient.NewLine,v.Local.sMessage)
	f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtAll.RowCount--,1)
		f.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).ScheduleWO!fieldval,=,"True")
			F.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).CODE_SOURCE!fieldvaltrim,=,"MJ","or",v.DataTable.dtAll(v.Local.i).CODE_SOURCE!fieldvaltrim,=,"MS")
				v.Local.spart.Set(v.DataTable.dtAll(v.Local.i).SOPart!fieldvaltrim)
				v.Local.sJob.Set(v.DataTable.dtAll(v.Local.i).WO!fieldvaltrim)
				v.Local.sSuf.Set(v.DataTable.dtAll(v.Local.i).SUFFIX!FIELDVALTRIM)	
				f.Intrinsic.String.Concat(v.Local.sMessage," ",v.DataTable.dtAll(v.Local.i).SOPart!fieldval," --- ",v.DataTable.dtAll(v.Local.i).Description!fieldval,v.Ambient.NewLine,V.Local.sMessage)
				f.Data.DataTable.AddRow("dtPrint","Part",v.Local.spart,"Job",v.Local.sJob,"Suffix",v.Local.sSuf)
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Next(v.Local.i)
	
	'Reset i before continuing on
	v.Local.i.Set(0)
	f.Intrinsic.Control.If(v.DataTable.dtPrint.RowCount,<>,0)
		f.Intrinsic.UI.Msgbox(v.Local.sMessage,"Print Documents?",4,v.Local.lret)
	f.Intrinsic.Control.Else
		f.Intrinsic.UI.Msgbox("No valid lines selected.  Please double check that the source code is Manufactured (M or F).")
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.Control.If(v.Local.lret,=,6)
		f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtPrint.RowCount--,1)
			v.Local.spart.Set(v.DataTable.dtPrint(v.Local.i).Part!fieldvaltrim)
			v.Local.sJob.Set(v.DataTable.dtPrint(v.Local.i).Job!fieldvaltrim)
			v.Local.sSuf.Set(v.DataTable.dtPrint(v.Local.i).Suffix!FIELDVALTRIM)				
			F.Global.Inventory.GetGSSPart(V.Local.sPart,"",V.Local.sShortRet)

			'Grab Ids
			F.Intrinsic.String.Build("Select Part From V_JOB_Header Where Job = '{0}' And Suffix = '{1}'",v.Local.sjob,v.Local.sSuf,V.Local.sSql)
			f.Intrinsic.Control.If(v.DataTable.dtGrab.Exists)
				f.Data.DataTable.Close("dtGrab")
			f.Intrinsic.Control.EndIf
			f.Data.DataTable.CreateFromSQL("dtGrab",con,v.Local.ssql,true)
			f.Intrinsic.Control.For(v.Local.j,0,v.DataTable.dtGrab.RowCount--,1)
				
				F.Global.DocumentControl.CreateReference(v.DataTable.dtGrab(v.Local.j).PART!FIELDVALTRIM,30,V.Local.iLinkID)
				F.Intrinsic.Control.If(V.Local.iLinkID,>,0)
					
					'Grab the files
					F.Intrinsic.String.Build("SELECT * FROM ATG_DOC_ASSOC WHERE LINK_ID = {0}",v.Local.iLinkID,v.Local.ssql)
					f.Intrinsic.Control.If(v.DataTable.dtFiles.Exists)
						f.Data.DataTable.Close("dtFiles")
					f.Intrinsic.Control.EndIf
					f.Data.DataTable.CreateFromSQL("dtFiles",con,v.Local.ssql,true)
					
					f.Intrinsic.Control.If(v.DataTable.dtFiles.RowCount,<>,0)
						f.Intrinsic.Control.For(v.Local.k,0,v.DataTable.dtFiles.RowCount--,1)
							
							F.Intrinsic.String.Right(v.DataTable.dtFiles(v.Local.k).PATH!FieldvalTrim,1,V.Local.stemp)
							f.Intrinsic.Control.If(v.Local.sTemp,=,"\")
								F.Intrinsic.String.Concat(v.DataTable.dtFiles(v.Local.k).PATH!FieldvalTrim,v.DataTable.dtFiles(v.Local.k).FILE!FieldvalTrim,V.Local.stemp)
							f.Intrinsic.Control.Else
								F.Intrinsic.String.Concat(v.DataTable.dtFiles(v.Local.k).PATH!FieldvalTrim,"\",v.DataTable.dtFiles(v.Local.k).FILE!FieldvalTrim,V.Local.stemp)
							f.Intrinsic.Control.EndIf
							
							'If it cannot print a document, catch it
							f.Intrinsic.Control.Try
								F.Intrinsic.task.ShellExec(V.Caller.Handle,"PRINT",V.local.sTemp,"","",5)
							f.Intrinsic.Control.Catch
							f.Intrinsic.Control.EndTry
							f.Intrinsic.UI.SleepMS(3000)
						f.Intrinsic.Control.Next(v.Local.k)
					f.Intrinsic.Control.Else
						f.Intrinsic.String.Concat("No documents found for part: ",v.Local.sPart,v.Local.sMessage)
						f.Intrinsic.UI.Msgbox(v.Local.sMessage)
					f.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			f.Intrinsic.Control.Next(v.Local.j)
		f.Intrinsic.Control.Next(v.Local.i)
		
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	f.Intrinsic.Control.EndIf
	
	gui.FrmOrderReview.GsGCAllOpen.enabled(True)
f.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.Intrinsic.Control.CallSub(FrmOrderReview_UnLoad)
f.Intrinsic.Control.EndTry
Program.Sub.cmdPrintDoc_Click.End

Program.Sub.cmdCreateParts_Click.Start
f.Intrinsic.Control.Try

	gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	v.Local.i.Declare(long)
	v.Local.j.Declare(long)
	v.Local.ssql.Declare(string)
	v.Local.spart.Declare(string)
	v.Local.sUm.Declare(string)
	v.Local.sDescription.Declare(string)
	v.Local.sLoc.Declare(string)
	v.Local.sPL.Declare(string)
	v.Local.sSource.Declare(string)
	v.Local.sMessage.Declare(string)
	v.Local.sShortRet.Declare(string)
	v.Local.sParams.Declare(string)
	v.Local.sLongDesc.Declare(string)
	v.Local.fPrice.Declare(float)
	v.Local.lret.Declare(long)
	
	f.Intrinsic.Control.If(v.DataTable.dtParts.Exists)
		f.Data.DataTable.Close("dtParts")
	f.Intrinsic.Control.EndIf	
	
	f.Data.DataTable.Create("dtParts","true")
	f.Data.DataTable.AddColumn("dtParts","Part","String")
	f.Data.DataTable.AddColumn("dtParts","Desc","String")
	f.Data.DataTable.AddColumn("dtParts","PrdL","String")
	f.Data.DataTable.AddColumn("dtParts","UoMs","String")
	f.Data.DataTable.AddColumn("dtParts","Long","String")
	f.Data.DataTable.AddColumn("dtParts","Prce","Float")
	f.Data.DataTable.AddColumn("dtParts","Orig","Long")
	'Verify if the user wants to do this.
	f.Intrinsic.String.Concat("Create/Maintain Parts for: ",v.Ambient.NewLine,v.Local.sMessage)
	f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtAll.RowCount--,1)
		f.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).ScheduleWO!fieldval,=,"True")
			f.Intrinsic.String.Build("select um_order from V_ORDER_LINES where ORDER_NO='{0}' and RECORD_NO='{1}0'",v.DataTable.dtAll(v.Local.i).SO!FIELDVALTRIM,v.DataTable.dtAll(v.Local.i).SOLine!FIELDVALTRIM,v.Local.ssql)
			f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.sUm)
			f.Intrinsic.String.Build("select price_order from V_ORDER_LINES where ORDER_NO='{0}' and RECORD_NO='{1}0'",v.DataTable.dtAll(v.Local.i).SO!FIELDVALTRIM,v.DataTable.dtAll(v.Local.i).SOLine!FIELDVALTRIM,v.Local.ssql)
			f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.fPrice)
			'Get long Description
			f.Intrinsic.String.Build("SELECT text from ORDER_LN_TEXT WHERE ORDER_NUM='{0}' AND ORDER_LINE='{1}0'",v.DataTable.dtAll(v.Local.i).SO!FIELDVALTRIM,V.DataTable.dtAll(v.Local.i).SOLine!fieldvaltrim,v.Local.ssql)
			f.Intrinsic.Control.If(v.DataTable.dtLng.Exists)
				f.Data.DataTable.Close("dtLng")
			f.Intrinsic.Control.EndIf
			f.Data.DataTable.CreateFromSQL("dtLng",con,v.Local.ssql,true)
			f.Intrinsic.Control.For(v.Local.j,0,v.DataTable.dtLng.RowCount--,1)
				f.Intrinsic.String.Concat(v.Local.sLongDesc,v.DataTable.dtLng(v.Local.j).TEXT!FIELDVALTRIM,v.Ambient.NewLine,v.Local.sLongDesc)
			f.Intrinsic.Control.Next(v.Local.j)
			v.Local.spart.Set(v.DataTable.dtAll(v.Local.i).SOPart!fieldvaltrim)
			v.Local.sDescription.Set(v.DataTable.dtAll(v.Local.i).Description!fieldvaltrim)
			v.Local.sPL.Set(v.DataTable.dtAll(v.Local.i).Product_Line!FIELDVALTRIM)	
			f.Intrinsic.String.Concat(v.Local.sMessage," ",v.DataTable.dtAll(v.Local.i).SOPart!fieldval," --- ",v.DataTable.dtAll(v.Local.i).Description!fieldval,v.Ambient.NewLine,V.Local.sMessage)
			f.Data.DataTable.AddRow("dtParts","Part",v.Local.spart,"Desc",v.Local.sDescription,"PrdL",v.Local.sPL,"UoMs",v.Local.sUm,"Prce",v.Local.fPrice,"Orig",v.Local.i,"Long",v.Local.sLongDesc)
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Next(v.Local.i)
	
	'Reset i before continuing on
	v.Local.i.Set(0)
	f.Intrinsic.UI.Msgbox(v.Local.sMessage,"Create Parts?",4,v.Local.lret)
	f.Intrinsic.Control.If(v.Local.lret,=,6)
		f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtParts.RowCount--,1)
			v.Local.spart.Set(v.DataTable.dtParts(v.Local.i).Part!fieldvaltrim)
			v.Local.sDescription.Set(v.DataTable.dtParts(v.Local.i).Desc!fieldvaltrim)
			v.Local.sPL.Set(v.DataTable.dtParts(v.Local.i).PrdL!FIELDVALTRIM)
			v.Local.sUm.Set(v.DataTable.dtParts(v.Local.i).UoMs!FIELDVALTRIM)		
			v.Local.sLongDesc.Set(v.DataTable.dtParts(v.Local.i).Long!fieldvaltrim)
			V.Local.fPrice.Set(V.DataTable.dtParts(v.Local.i).Prce!fieldval)
			F.Global.Inventory.GetGSSPart(V.Local.sPart,"",V.Local.sShortRet)
			f.Global.Inventory.CreatePart(v.Local.sShortRet,v.Local.sUm,v.Local.sDescription,v.Local.sLoc,v.Local.sPL,"","","",v.Local.fPrice,"NOMAINT")
			f.Intrinsic.Control.CallSub(longdesc,"Part",v.Local.sShortRet,"LongDesc",v.Local.sLongDesc)
			F.Intrinsic.String.ConcatCallWrapperArgs("O","D",v.Local.sShortRet,v.Local.sParams)
			F.Intrinsic.String.Concat(V.Caller.CompanyCode,"!*!","O","!*!","!*!","!*!",v.Local.sShortRet.UCase,"!*!","",V.Local.sParams)
			F.Global.General.CallWrappersync(3500,V.Local.sParams)
			f.Data.DataTable.SetValue("dtAll",v.DataTable.dtParts(v.Local.i).Orig!Fieldval,"ScheduleWO","False")
			f.Data.DataTable.SetValue("dtAll",v.DataTable.dtParts(v.Local.i).Orig!fieldval,"GSSPart",v.Local.sShortRet)
		f.Intrinsic.Control.Next(v.Local.i)
	f.Intrinsic.Control.EndIf
	
	gui.FrmOrderReview.GsGCAllOpen.enabled(True)
f.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.Intrinsic.Control.CallSub(FrmOrderReview_UnLoad)
f.Intrinsic.Control.EndTry
Program.Sub.cmdCreateParts_Click.End

Program.Sub.longDesc.Start
f.Intrinsic.Control.Try
	v.Local.ssql.Declare
	v.Local.sret.Declare
	v.Local.spart.Declare
	v.Local.sLong.Declare
	v.Local.spart.Set(v.Args.part)
	v.Local.sLong.Set(v.Args.longdesc)
	
	f.Intrinsic.String.Build("SELECT PART, TEXT FROM INV_EXTRA_TEXT WHERE PART='{0}'",v.Local.spart,v.Local.ssql)
	f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.sret)
	f.Intrinsic.Control.If(v.Local.sret.Trim,=,"")
		f.Intrinsic.String.Build("INSERT INTO INV_EXTRA_TEXT VALUES ('{0}','{1}')",v.Local.spart,v.Local.sLong,v.Local.ssql)
		f.ODBC.Connection!con.execute(v.Local.ssql)
	f.Intrinsic.Control.Else
'		f.Intrinsic.String.Build("UPDATE INV_EXTRA_TEXT SET TEXT='{0}' WHERE PART='{1}'",V.Local.sLong,v.Local.spart,v.Local.ssql)
'		f.ODBC.Connection!con.execute(v.Local.ssql)
	f.Intrinsic.Control.EndIf
f.Intrinsic.Control.Catch
	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
f.Intrinsic.Control.EndTry
Program.Sub.longDesc.End

Program.Sub.Schedule.Start
f.Intrinsic.Control.Try
	GUI.FrmOrderReview.GsGCAllOpen.enabled(false)
	v.Local.sswitch.Declare
	v.Local.SSQL.Declare
	v.Local.irows.Declare(long)
	V.Local.iRows.Set(0)
	v.Local.i.Declare(long)
	v.Local.ddate.Declare(date)
	V.Local.dToday.Declare(date)
	v.Local.sdate.Declare
	V.Local.SDATELong.declare
	V.Local.sDateUS.Declare
	V.Local.DDATEUS.Declare(date)
	V.Local.SDUE.Declare
	v.Local.sDateSched.declare
	v.Local.sparams.Declare
	v.Local.sMessage.Declare
	v.Local.sret.Declare
	v.Local.lret.Declare(long)
	v.Local.sFileDir.Declare
	V.Local.spart.Declare
	V.Local.spartrev.Declare
	v.Local.fSuffix.Declare(float)
	v.Local.sSuffix.Declare
	v.Local.lID.Declare(long)
	v.Local.lSched.Declare
	V.Local.sNames.Declare
	v.Local.sValues.Declare
	V.Local.sMChk.Declare
	v.Local.x.Declare(long)
	v.Local.y.Declare(long)
	v.Local.bExit.Declare(boolean)
	v.Local.sCMarkFile.Declare
	v.Local.sMark.Declare
	
	f.Intrinsic.String.Concat(v.Caller.GasDir,"\GAB_5219_COMPLETION.txt",v.Local.sCMarkFile)
	f.Intrinsic.File.File2String(v.Local.sCMarkFile,v.Local.sMark)
	
	
	v.Local.dToday.Set(v.Ambient.Date)
	v.Local.sswitch.Set(v.Args.sSwitch)
	f.Intrinsic.Control.If(v.DataTable.dtWO.Exists)
		f.Data.DataTable.Close("dtWO")
	f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.If(v.DataTable.dtWOP.Exists)
		f.Data.DataTable.Close("dtWOP")
	f.Intrinsic.Control.EndIf
	
	'Datatable for storing original work orders' position in the grid control
	f.Data.DataTable.Create("dtWO")
	f.Data.DataTable.AddColumn("dtWO","SO","string")
	f.Data.DataTable.AddColumn("dtWO","SOLine","string")
	f.Data.DataTable.AddColumn("dtWO","SODueDate","string")
	f.Data.DataTable.AddColumn("dtWO","OrigRow","long")
	
	'Datatable for printing work orders
	f.Data.DataTable.Create("dtWOP")
	f.Data.DataTable.AddColumn("dtWOP","WO","String")
	f.Data.DataTable.AddColumn("dtWOP","Suffix","string")
	
	'Start the process of formatting the data for Global Shop
	f.Intrinsic.Control.If(v.Local.sswitch,=,"N")
		f.Intrinsic.String.Concat("Create work orders for sales orders: ",V.Ambient.NewLine,v.Local.sMessage)
	f.Intrinsic.Control.ElseIf(v.Local.sswitch,=,"R")
		f.Intrinsic.String.Concat("Reschedule Work Orders: ",V.Ambient.NewLine,v.Local.sMessage)
	f.Intrinsic.control.EndIf
	
	f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtAll.RowCount--,1)
		f.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).ScheduleWO!fieldval,=,"True")
			'f.Intrinsic.Debug.ShowCallerInfo
			f.Intrinsic.String.Left(v.DataTable.dtAll(v.Local.i).CODE_SOURCE!fieldvaltrim,1,v.Local.sMChk)
			'F.Intrinsic.Control.If(v.Local.sMChk.Trim,=,"M","or",v.DataTable.dtAll(v.Local.i).RtrCompl!fieldval,=,True)
			'omitted for demo only, put back!!!!
			'F.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).RtrCompl!fieldval,=,v.Local.sMark)
				F.Intrinsic.Control.If(V.DataTable.dtAll(V.Local.i).SODueDate!FieldVal,!=,V.Ambient.MinDate)
					f.Intrinsic.String.Concat(v.Local.sMessage," ",v.DataTable.dtAll(v.Local.i).SO!fieldval,"-",v.DataTable.dtAll(v.Local.i).SOLINE!fieldval," ",V.DataTable.dtAll(V.Local.I).SOQty!FIELDVALTrim," of ",V.DataTable.dtAll(V.Local.I).SOPart!FieldvalTrim," ",v.Ambient.NewLine,V.Local.sMessage)
					f.Intrinsic.String.Mid(v.DataTable.dtAll(v.Local.i).SOPART!FIELDVAL,18,3,v.Local.spartrev)
					f.Intrinsic.String.mid(v.DataTable.dtAll(v.Local.i).SOPART!FIELDVAL,1,17,v.Local.spart)
					f.Data.DataTable.AddRow("dtWO","SO",v.DataTable.dtAll(v.Local.i).SO!FIELDVAL,"SOLine",v.DataTable.dtAll(v.Local.i).SOLINE!Fieldval,"SODueDate",v.DataTable.dtAll(v.Local.i).SODueDate!FIELDVALString,"OrigRow",v.Local.i)
				F.Intrinsic.Control.EndIf
			'f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Next(v.Local.i)
	
	'Reset i before continuing on
	v.Local.i.Set(0)
	f.Intrinsic.Control.If(v.DataTable.dtWO.RowCount,<>,0)
		f.Intrinsic.UI.Msgbox(v.Local.sMessage,"Create Work Orders",4,v.Local.lret)
	f.Intrinsic.Control.Else
		f.Intrinsic.UI.Msgbox("No valid orders selected.  Please double check the router is complete and that the sales order due date is valid.")
		GUI.FrmOrderReview.GsGCAllOpen.enabled(true)
		F.Intrinsic.Control.ExitSub
	f.Intrinsic.Control.EndIf
	
	'fIND OUT IF FORWARD SCHEDULING IS TURNED ON
	F.ODBC.Connection!con.executeandreturn("SELECT IFNULL(F_LONG,0) FROM OP_HEADER WHERE ID='401162' AND SEQUENCE='0000'",v.Local.lSched)
			
			
	f.Intrinsic.Control.If(v.Local.lret,=,6)
		f.Intrinsic.UI.InvokeWaitDialog("Generating Work Orders and Scheduling.")
		F.Intrinsic.Control.For(V.Local.i,0,v.DataTable.dtWO.RowCount--,1)
			v.Local.ddate.set(V.DataTable.dtWO(v.Local.i).SODueDate!FieldValString)
			f.Intrinsic.String.Format(v.Local.ddate,"dd/mm/yyyy",v.Local.sdatesched)
			f.Intrinsic.String.Format(v.Local.ddate,"MMDDYY",v.Local.sdate)
			f.Intrinsic.String.Format(v.Local.ddate,"YYYYMMDD",v.Local.SDATELong)
			F.Intrinsic.String.Format(V.Local.ddate,"DD/MM/YY",V.Local.SDATEUS)
			'Create the WO from SO
			f.Intrinsic.Control.If(v.Local.sswitch,=,"N")
				f.Intrinsic.String.Concat("O!*!",v.DataTable.dtWO(v.local.i).SO!fieldvaltrim,"!*!",v.DataTable.dtWO(v.local.i).SOLine!fieldvaltrim,"0!*!1",v.Local.sparams)
				f.Global.General.CallWrappersync(200801,v.Local.sparams)
			f.Intrinsic.Control.EndIf
			
			'Uncheck the boxes
			f.Data.DataTable.SetValue("dtAll",v.DataTable.dtWO(v.Local.i).OrigRow!fieldvallong,"ScheduleWO","False")
			
			'WO Creation set, much faster
			f.Data.DataTable.SetValue("dtAll",v.DataTable.dtWO(v.Local.i).OrigRow!fieldvallong,"WOCreated","True")
		f.Intrinsic.Control.Next(v.Local.i)
		
		'Bumped this out after the fact, let the scheduling happen as is for speed reasons
		'AFter WO creation, grab the WO number
		F.Intrinsic.Control.For(V.Local.i,0,v.DataTable.dtWO.RowCount--,1)
			f.Intrinsic.String.Build("SELECT JOB, SUFFIX FROM V_ORDER_TO_WO WHERE ORDER_NO='{0}' AND ORDER_LINE='{1}0'",v.DataTable.dtWO(v.local.i).SO!fieldvaltrim,v.DataTable.dtWO(v.local.i).SOLine!fieldvaltrim,v.Local.SSQL)
			f.ODBC.Connection!con.executeandreturn(v.Local.SSQL,v.Local.sret)
			f.Intrinsic.String.Split(v.Local.sret,"*!*",v.Local.sret)
			v.Local.ddate.set(V.DataTable.dtWO(v.Local.i).SODueDate!FieldValString)
			
			'Write the WO/Suffix to the cell
			f.Data.DataTable.SetValue("dtAll",v.DataTable.dtWO(v.Local.i).OrigRow!fieldvallong,"WO",v.Local.sret)
			f.Intrinsic.Control.If(v.Local.sret.UBound,>=,1)
				f.Data.DataTable.SetValue("dtAll",V.DataTable.dtWO(v.Local.i).OrigRow!fieldvallong,"Suffix",v.Local.sret(1))
				'Add it to print table
				f.Data.DataTable.AddRow("dtWOP","WO",v.Local.sret(0),"Suffix",v.Local.sret(1))
			f.Intrinsic.Control.Else
				'Add to print table, this routine should not happen.
				f.Data.DataTable.AddRow("dtWOP","WO",v.Local.sret(0),"Suffix","")
			f.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.If(V.Local.sswitch,=,"R")
				F.Intrinsic.Control.If(v.Local.lSched,=,"2","or",v.Local.lSched,=,"3")
					F.Global.APS.ScheduleJob(v.Local.sret(0),v.Local.sret(1),"F",v.Local.dToday)
				f.Intrinsic.Control.Else
					F.Global.APS.ScheduleJob(v.Local.sret(0),v.Local.sret(1),"B",v.Local.ddate)
					'To correct bug where user checks line and goes to reschedule.
					f.Intrinsic.String.Format(v.Local.ddate,"MMDDYY",v.Local.sdate)
					F.Intrinsic.String.Concat("UPDATE JOB_HEADER SET DATE_DUE='",v.Local.sdate,"' WHERE JOB='",v.Local.sRet(0),"' and SUFFIX='",V.Local.sRet(1),"'",V.Local.sSQL)
					F.ODBC.Connection!con.Execute(v.Local.ssql)
				F.Intrinsic.Control.EndIf
			f.Intrinsic.Control.ElseIf(v.Local.sswitch,=,"N")
				'ONLY FORWARD SCHEDULE IF COMPANY OPTION TURNED ON.
				F.Intrinsic.Control.If(v.Local.lSched,=,"2","or",v.Local.lSched,=,"3")
					F.Global.APS.ScheduleJob(v.Local.sret(0),v.Local.sret(1),"F",v.Local.dToday)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
			'If Suffix = '000' then it is a BOM and need to grab the others
			f.Intrinsic.Control.If(v.Local.sret.UBound,>=,1)
				F.Intrinsic.Control.If(V.Local.sret(1),=,"000")
					f.Intrinsic.string.Build("select max(suffix) from V_JOB_HEADER  where job='{0}'",v.Local.sret(0),v.Local.SSQL)
					f.ODBC.Connection!con.executeandreturn(v.Local.SSQL,v.Local.fSuffix)
					f.Intrinsic.Control.For(v.Local.x,1,v.Local.fSuffix,1)
						f.Intrinsic.String.LPad(v.Local.x,"0",3,v.Local.sSuffix)
						f.Data.DataTable.AddRow("dtWOP","WO",v.Local.sret(0),"Suffix",v.Local.sSuffix)
					f.Intrinsic.Control.next(v.Local.x)
				F.Intrinsic.Control.EndIf
			f.Intrinsic.Control.EndIf
			v.Local.fSuffix.Set(1)
		f.Intrinsic.Control.Next(v.Local.i)
		f.Intrinsic.Control.CallSub(cmdRefresh_Click)

		f.Intrinsic.UI.CloseWaitDialog
	f.Intrinsic.Control.EndIf
	GUI.FrmOrderReview.GsGCAllOpen.enabled(true)
f.Intrinsic.Control.Catch
	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
	f.ODBC.Connection!con.Close
	f.Intrinsic.Control.End
f.Intrinsic.Control.endtry
Program.Sub.Schedule.End

Program.Sub.cmdBWDSched_Click.Start
f.Intrinsic.Control.CallSub(schedule,"sSwitch","N")
Program.Sub.cmdBWDSched_Click.End

Program.Sub.cmdResched_Click.Start
f.Intrinsic.Control.CallSub(schedule,"sSwitch","R")
Program.Sub.cmdResched_Click.End

Program.Sub.cmdCreateRtr_Click.Start
f.Intrinsic.Control.Try

	gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	v.Local.i.Declare(long)
	v.Local.ssql.Declare(string)
	v.Local.spart.Declare(string)
	v.Local.sUm.Declare(string)
	v.Local.sDescription.Declare(string)
	v.Local.sLoc.Declare(string)
	v.Local.sPL.Declare(string)
	v.Local.sSource.Declare(string)
	v.Local.sMessage.Declare(string)
	v.Local.sShortRet.Declare(string)
	v.Local.sParams.Declare(string)
	v.Local.sret.Declare(string)
	v.Local.fPrice.Declare(float)
	v.Local.lret.Declare(long)
	v.Local.sMChk.Declare(string)
	
	f.Intrinsic.Control.If(v.DataTable.dtRtrs.Exists)
		f.Data.DataTable.Close("dtRtrs")
	f.Intrinsic.Control.EndIf	
	
	f.Data.DataTable.Create("dtRtrs","true")
	f.Data.DataTable.AddColumn("dtRtrs","Part","String")
	f.Data.DataTable.AddColumn("dtRtrs","Desc","String")
	f.Data.DataTable.AddColumn("dtRtrs","PrdL","String")
	f.Data.DataTable.AddColumn("dtRtrs","UoMs","String")
	f.Data.DataTable.AddColumn("dtRtrs","Prce","Float")
	f.Data.DataTable.AddColumn("dtRtrs","Orig","Long")
	'Verify if the user wants to do this.
	f.Intrinsic.String.Concat("Create/Maintain Routers for: ",v.Ambient.NewLine,v.Local.sMessage)
	f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtAll.RowCount--,1)
		f.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).ScheduleWO!fieldval,=,"True")
			f.Intrinsic.String.Left(v.DataTable.dtAll(v.Local.i).CODE_SOURCE!fieldvaltrim,1,v.Local.sMChk)
			F.Intrinsic.Control.If(v.Local.sMChk,=,"M","or",v.DataTable.dtAll(v.Local.i).RtrCompl!fieldval,=,True)
				f.Intrinsic.String.Build("select um_order from V_ORDER_LINES where ORDER_NO='{0}' and RECORD_NO='{1}0'",v.DataTable.dtAll(v.Local.i).SO!FIELDVALTRIM,v.DataTable.dtAll(v.Local.i).SOLine!FIELDVALTRIM,v.Local.ssql)
				f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.sUm)
				f.Intrinsic.String.Build("select price_order from V_ORDER_LINES where ORDER_NO='{0}' and RECORD_NO='{1}0'",v.DataTable.dtAll(v.Local.i).SO!FIELDVALTRIM,v.DataTable.dtAll(v.Local.i).SOLine!FIELDVALTRIM,v.Local.ssql)
				f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.fPrice)
				v.Local.spart.Set(v.DataTable.dtAll(v.Local.i).SOPart!fieldvaltrim)
				v.Local.sDescription.Set(v.DataTable.dtAll(v.Local.i).Description!fieldvaltrim)
				v.Local.sPL.Set(v.DataTable.dtAll(v.Local.i).Product_Line!FIELDVALTRIM)	
				f.Intrinsic.String.Concat(v.Local.sMessage," ",v.DataTable.dtAll(v.Local.i).SOPart!fieldval," --- ",v.DataTable.dtAll(v.Local.i).Description!fieldval,v.Ambient.NewLine,V.Local.sMessage)
				f.Data.DataTable.AddRow("dtRtrs","Part",v.Local.spart,"Desc",v.Local.sDescription,"PrdL",v.Local.sPL,"UoMs",v.Local.sUm,"Prce",v.Local.fPrice,"Orig",v.Local.i)
			f.Intrinsic.Control.EndIf
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Next(v.Local.i)
	
	'Reset i before continuing on
	v.Local.i.Set(0)
	f.Intrinsic.Control.If(v.DataTable.dtRtrs.RowCount,<>,0)
		f.Intrinsic.UI.Msgbox(v.Local.sMessage,"Create/Maintain Routers?",4,v.Local.lret)
	f.Intrinsic.Control.Else
		f.Intrinsic.UI.Msgbox("No valid lines selected.  Please double check that the source code is Manufactured (M or F).")
	f.Intrinsic.Control.EndIf
	
	f.Intrinsic.Control.If(v.Local.lret,=,6)
		f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtRtrs.RowCount--,1)
			v.Local.spart.Set(v.DataTable.dtRtrs(v.Local.i).Part!fieldvaltrim)
			v.Local.sDescription.Set(v.DataTable.dtRtrs(v.Local.i).Desc!fieldvaltrim)
			v.Local.sPL.Set(v.DataTable.dtRtrs(v.Local.i).PrdL!FIELDVALTRIM)
			v.Local.sUm.Set(v.DataTable.dtRtrs(v.Local.i).UoMs!FIELDVALTRIM)
			
			f.Intrinsic.Control.If(v.Global.bLongPart)
				F.Global.Inventory.GetGSSPart(V.Local.sPart,"",V.Local.sShortRet)
			f.Intrinsic.Control.Else
				v.Local.sShortRet.Set(v.Local.sPart.Trim)
			f.Intrinsic.Control.EndIf
			
			f.Intrinsic.String.Build("SELECT * FROM V_ROUTER_HEADER WHERE ROUTER='{0}'",v.Local.sShortRet,v.Local.ssql)
			f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.sret)


			f.Intrinsic.Control.If(v.Local.sret.Trim,=,"")
				'Open new router screen
				F.Intrinsic.String.ConcatCallWrapperArgs("N",v.Local.sShortRet,v.Local.sParams)
				F.Global.General.CallWrappersync(400000,V.Local.sParams)
			f.Intrinsic.Control.Else
				'Open existing router screen
				F.Intrinsic.String.ConcatCallWrapperArgs("O",v.Local.sShortRet,v.Local.sParams)
				F.Global.General.CallWrappersync(400000,V.Local.sParams)
			f.Intrinsic.Control.EndIf
			f.Data.DataTable.SetValue("dtAll",v.DataTable.dtRtrs(v.Local.i).Orig!Fieldval,"ScheduleWO","False")
			f.Data.DataTable.SetValue("dtAll",v.DataTable.dtRtrs(v.Local.i).Orig!fieldval,"GSSPart",v.Local.sShortRet)
		f.Intrinsic.Control.Next(v.Local.i)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	f.Intrinsic.Control.EndIf
	
	gui.FrmOrderReview.GsGCAllOpen.enabled(True)
f.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.Intrinsic.Control.CallSub(FrmOrderReview_UnLoad)
f.Intrinsic.Control.EndTry
Program.Sub.cmdCreateRtr_Click.End

Program.Sub.cmdCreateBOM_Click.Start
f.Global.General.CallWrapperAsync(50,"BM0020GI/O")
Program.Sub.cmdCreateBOM_Click.End

Program.Sub.addPOText.Start
f.Intrinsic.Control.Try
	v.Local.ssql.Declare
	v.Local.sRet.Declare
	F.Intrinsic.String.Build("select * from PO_LN_TEXT WHERE PO_NUM='{0}' AND LINE='{1}0'",v.Args.PONum,v.Args.POLn,v.Local.ssql)
	f.ODBC.Connection!con.ExecuteAndReturn(v.Local.ssql,v.Local.sret)
	f.Intrinsic.Control.If(v.Local.sRet.Trim,=,"")
		f.Intrinsic.String.Build("INSERT INTO PO_LN_TEXT (PO_NUM,LINE,TEXT) VALUES ('{0}','{1}0','{2}')",v.Args.PONum,v.Args.POLn,v.Args.POText,v.Local.ssql)
		f.ODBC.Connection!con.execute(v.Local.ssql)
	f.Intrinsic.Control.Else
		f.Intrinsic.String.Build("UPDATE PO_LN_TEXT SET TEXT='{0}' WHERE PO_NUM='{1}' AND LINE='{2}0'",v.Args.POText,v.Args.PONum,v.Args.POLn,v.Local.ssql)
		f.ODBC.Connection!con.execute(v.Local.ssql)
	f.Intrinsic.Control.EndIf
f.Intrinsic.Control.Catch
	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
	f.Intrinsic.Control.CallSub(frmOrderReview_Unload)
f.Intrinsic.Control.EndTry
Program.Sub.addPOText.End

Program.Sub.cmdCreatePO_Click.Start
'f.Intrinsic.Control.Try
	'v.Local.i.Declare(long)
	'v.Local.ssql.Declare(string)
	'v.Local.spart.Declare(string)
	'v.Local.sUm.Declare(string)
	'v.Local.sDescription.Declare(string)
	'v.Local.sLoc.Declare(string)
	'v.Local.sPL.Declare(string)
	'v.Local.sSource.Declare(string)
	'v.Local.sMessage.Declare(string)
	'v.Local.sShortRet.Declare(string)
	'v.Local.sParams.Declare(string)
	'v.Local.sret.Declare(string)
	'V.Local.sHold.Declare(string)
	'V.Local.sDate.Declare(string)
	'v.Local.sGSSPart.Declare(string)
	'V.Local.sGLACCOUNT.Declare(string)
	'v.Local.sSOHead.Declare(string)
	'v.Local.sSOLine.Declare(string)
	'v.Local.sVend.Declare(string)
	'v.Local.dDate.Declare(date)
	'v.Local.fPrice.Declare(float)
	'v.Local.fcost.Declare(float)
	'V.Local.fACst.Declare(float)
	'v.Local.fICst.Declare(float)
	'v.Local.fQty.Declare(float)
	'v.Local.lret.Declare(long)
	
	'f.Intrinsic.Control.If(v.DataTable.dtPO.Exists)
	'	f.Data.DataTable.Close("dtPO")
	'f.Intrinsic.Control.EndIf	
	
	'f.Data.DataTable.Create("dtPO","true")
	'f.Data.DataTable.AddColumn("dtPO","Part","String")
	'f.Data.DataTable.AddColumn("dtPO","Desc","String")
	'f.Data.DataTable.AddColumn("dtPO","Vend","String")
	'f.Data.DataTable.AddColumn("dtPO","PrdL","String")
	'f.Data.DataTable.AddColumn("dtPO","UoMs","String")
	'f.Data.DataTable.AddColumn("dtPO","Cost","Float")
	'f.Data.DataTable.AddColumn("dtPO","ACst","Float")
	'f.Data.DataTable.AddColumn("dtPO","ICst","Float")
	'f.Data.DataTable.AddColumn("dtPO","Orig","Long")
	'f.Data.DataTable.AddColumn("dtPO","Date","String")
	'f.Data.DataTable.AddColumn("dtPO","Qnty","Float")
	'f.Data.DataTable.AddColumn("dtPO","Acct","String")
	'f.Data.DataTable.AddColumn("dtPO","GPrt","String")
	'f.Data.DataTable.AddColumn("dtPO","SOHD","String")
	'f.Data.DataTable.AddColumn("dtPO","SOLI","String")
	'Verify if the user wants to do this.
	'f.Intrinsic.String.Concat("Create Purchase Order for: ",v.Ambient.NewLine,v.Local.sMessage)
	'f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtAll.RowCount--,1)
	'	f.Intrinsic.Control.If(v.DataTable.dtAll(v.Local.i).ScheduleWO!fieldval,=,"True")
	'		v.Local.sPart.Set(v.DataTable.dtAll(v.Local.i).SOPart!fieldvaltrim)
	'		v.Local.sDescription.Set(v.DataTable.dtAll(v.Local.i).Description!fieldvaltrim)
	'		v.Local.sPL.Set(v.DataTable.dtAll(v.Local.i).Product_Line!FIELDVALTRIM)	
	'		V.Local.dDate.Set(v.DataTable.dtAll(v.Local.i).SODueDate!FIELDVAL)
	'		V.Local.sUm.Set(v.DataTable.dtAll(v.Local.i).UM_ORDER!FIELDVALTRIM)
	'		v.Local.fQty.Set(v.DataTable.dtAll(v.Local.i).SOQty!fieldval)
	'		v.Local.sGSSPart.Set(v.DataTable.dtAll(v.Local.i).GSSPart!FIELDVALTRIM)
	'		v.Local.sSOHead.Set(v.DataTable.dtAll(v.Local.i).SO!FieldvalTrim)
	'		v.Local.sSOLine.Set(v.DataTable.dtAll(v.Local.i).SOLine!FieldvalTrim)
			
	'		F.Intrinsic.String.Format(V.Local.dDate,"YYYYMMDD",V.Local.sDate)
	'		F.Intrinsic.String.Build("select PURCHASING_ACCOUNT from V_PRODUCT_LINE where PRODUCT_LINE='{0}'",v.Local.sPL,v.Local.ssql)
	'		f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.sGLAccount)
	'		f.Intrinsic.Control.If(v.Local.sGLACCOUNT.Trim,=,"")
				'Need to prepopulate if GL is blank		
	'		f.Intrinsic.Control.EndIf
			
			'Grab the alt cost
	'		F.Intrinsic.String.Build("select AMT_ALT_COST from V_INVENTORY_MSTR where PART='{0}'",v.Local.sGSSPart.Trim,v.Local.ssql)
	'		f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.fACst)
			
	'		F.Intrinsic.String.Build("select AMT_COST from V_INVENTORY_MSTR where PART='{0}'",v.Local.sGSSPart.Trim,v.Local.ssql)
	'		f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.fICst)
			
	'		F.Intrinsic.String.Build("select NAME_VENDOR from V_INVENTORY_MST2 where PART='{0}'",v.Local.sGSSPart.Trim,v.Local.ssql)
	'		f.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.sVend)
			
	'		v.Local.fcost.Set(v.Local.fACst)
	'		f.Intrinsic.Control.If(v.Local.fcost,=,0)
	'			v.Local.fcost.Set(v.Local.fICst)
	'		f.Intrinsic.Control.EndIf
			
	'		f.Intrinsic.String.Concat(v.Local.sMessage," ",v.DataTable.dtAll(v.Local.i).SOPart!fieldval," --- ",v.DataTable.dtAll(v.Local.i).Description!fieldval,v.Ambient.NewLine,V.Local.sMessage)
	'		f.Data.DataTable.AddRow("dtPO","SOHD",v.Local.sSOHead,"SOLI",v.Local.sSOLine,"Part",v.Local.spart,"Desc",v.Local.sDescription,"PrdL",v.Local.sPL,"UoMs",v.Local.sUm,"Cost",v.Local.fCost,"Orig",v.Local.i,"Date",v.Local.sDate,"Qnty",v.Local.fQty,"Acct",v.Local.sGLACCOUNT,"GPrt",v.Local.sGSSPart,"ACst",v.Local.fACst,"ICst",v.Local.fICst,"Vend",v.Local.sVend)
			
			
	'	f.Intrinsic.Control.EndIf
	'f.Intrinsic.Control.Next(v.Local.i)
	'gui.frmSelectVend.gsgcLines.DataSource("dtPO")
	'gui.frmSelectVend.gsgcLines.AddGridviewFromDatatable("gvPO","dtPO")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","Caption","Description")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","Caption","Product Line")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","Caption","UoM")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","Caption","Quantity")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Vend","Caption","Vendor Name")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Orig","Visible","False")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Date","Visible","False")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Acct","Visible","False")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","GPrt","Visible","False")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","SOHD","Visible","False")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","SOLI","Visible","False")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","ACst","Visible","False")
	'gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","ICst","Visible","False")
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","HeaderFontBold",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","HeaderFontBold",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","HeaderFontBold",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Cost","HeaderFontBold",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","HeaderFontBold",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","HeaderFontBold",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Vend","HeaderFontBold",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","HeaderHAlignment","Center")
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","HeaderHAlignment","Center")
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","HeaderHAlignment","Center")
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","HeaderHAlignment","Center")
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","HeaderHAlignment","Center")
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Cost","HeaderHAlignment","Center")
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Vend","HeaderHAlignment","Center")
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","ReadOnly",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","ReadOnly",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","ReadOnly",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","ReadOnly",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","ReadOnly",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Cost","ReadOnly",False)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","AllowEdit",False)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","AllowEdit",False)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","AllowEdit",False)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","AllowEdit",False)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","AllowEdit",False)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Cost","AllowEdit",True)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Vend","AllowEdit",False)
	'Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","CellForeColor","Blue")
	'gui.frmSelectVend.gsgcLines.anchor(15)
	'gui.frmSelectVend.cmdNewPO.anchor(6)
	'gui.frmSelectVend..Show
'f.Intrinsic.Control.Catch
'	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
'f.Intrinsic.Control.EndTry
Program.Sub.cmdCreatePO_Click.End

Program.Sub.cmdNewPO_Click.Start
f.Intrinsic.Control.Try
	f.Intrinsic.UI.InvokeWaitDialog("Processing Order")
	
	gui.FrmOrderReview.GsGCAllOpen.enabled(false)
	v.Local.shold.Declare(string)
	v.Local.sPart.Declare(string)
	v.Local.sDesc.Declare(string)
	v.Local.sEDes.Declare(string)
	V.Local.sSODs.Declare(string)
	v.Local.sPrdL.Declare(string)
	v.Local.sUoMs.Declare(string)
	v.Local.sAcct.Declare(string)
	v.Local.sDate.Declare(string)
	v.Local.sVend.Declare(string)
	v.Local.sParm.Declare(string)
	v.Local.sFile.Declare(string)
	V.Local.sRslt.Declare(string)
	v.Local.sLine.Declare(string)
	v.Local.sPONm.Declare(string)
	v.Local.sTemp.Declare(string)
	v.Local.sSQL.Declare(string)
	v.Local.fExtn.Declare(float)
	v.Local.fCost.Declare(float)
	v.Local.fQnty.Declare(float)
	v.Local.i.Declare(long)
	v.Local.j.Declare(long)
	
	'Create PO in Global Shop
	f.Data.DataTable.AddRow("175100","AutoNumber","Y","Addcomments","N","OpenPO","N")
	f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtPO.RowCount--,1)
		v.Local.sPart.Set(v.DataTable.dtPO(v.Local.i).GPRT!FIELDVALTRIM)
		v.Local.sDesc.Set(v.DataTable.dtPO(v.Local.i).DESC!FIELDVALTRIM)
		F.Intrinsic.String.Concat(v.DataTable.dtPO(v.Local.i).SOHD!FIELDVALTRIM,"-",V.DataTable.dtPO(v.Local.i).SOLI!FIELDVALTRIM,V.Local.sSODs)
		v.Local.sPrdL.Set(v.DataTable.dtPO(v.Local.i).PRDL!FIELDVALTRIM)
		v.Local.sUoMs.Set(v.DataTable.dtPO(v.Local.i).UOMS!FIELDVALTRIM)
		v.Local.sAcct.Set(v.DataTable.dtPO(v.Local.i).ACCT!FIELDVALTRIM)
		v.Local.sDate.Set(v.DataTable.dtPO(v.Local.i).DATE!FIELDVALTRIM)
		v.Local.sVend.Set(v.Screen.frmSelectVend!txtVendorNo.text)
		v.Local.fQnty.Set(v.DataTable.dtPO(v.Local.i).QNTY!FIELDVAL)
		v.Local.fCost.Set(v.DataTable.dtPO(v.Local.i).COST!FIELDVAL)
		F.Intrinsic.Math.Mult(v.Local.fCost,v.Local.fQnty,v.Local.fExtn)
		f.Data.DataTable.AddRow("175100File","Vendor",v.Local.sVend,"Part",v.Local.sPart,"Loc","","DueDate",v.Local.sDate,"Description",v.Local.sSODs,"InvUM",v.Local.sUoMs,"InvCost",v.Local.fCost,"InvQty",v.Local.fQnty,"POUM",v.Local.sUoMs,"POCost",v.Local.fCost,"POQty",v.Local.fQnty,"GLAccount",v.Local.sAcct,"Extension",v.Local.fExtn)
	f.Intrinsic.Control.Next(v.Local.i)
	f.Intrinsic.Control.CallSub(175100Sync)	
	
	'Read the resulting file to grab PO number
	f.Intrinsic.String.Concat(V.Caller.FilesDir,"\SLPUR",v.Caller.Terminal,".TXT",v.Local.sFile)
	f.Intrinsic.File.File2String(v.Local.sFile,v.Local.sRslt)
	f.Intrinsic.String.Left(v.Local.sRslt,7,v.Local.sPONm)
	
	'Query the PO and create datatable
	f.Intrinsic.String.Build("SELECT PURCHASE_ORDER, RECORD_NO, DESCRIPTION FROM V_PO_LINES WHERE PURCHASE_ORDER='{0}'",v.Local.sPONm,v.Local.ssql)
	f.Intrinsic.Control.If(v.DataTable.dtPOTemp.Exists)
		f.Data.DataTable.Close("dtPOTemp")
	f.Intrinsic.Control.EndIf
	f.Data.DataTable.CreateFromSQL("dtPOTemp","con",v.Local.sSQL,true)
	
	'Loop through and update the sales orders and replace with original description
	f.Intrinsic.Control.For(v.Local.i,0,v.DataTable.dtPOTemp.RowCount--,1)
		F.Intrinsic.String.Split(v.DataTable.dtPOTemp(v.Local.i).DESCRIPTION!FIELDVALTRIM,"-",v.Local.sTemp)
		
		f.Intrinsic.Control.If(v.Local.sTemp.UBound,>,0)
			f.Intrinsic.String.Build("SELECT DESCRIPTION FROM V_ORDER_LINES WHERE ORDER_NO='{0}' AND RECORD_NO='{1}0'",v.Local.stemp(0).trim,v.Local.sTemp(1).trim,v.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(v.Local.ssql,v.Local.sDesc)
		
			'Establish Extra Description
			f.Intrinsic.Control.If(v.DataTable.dtEDesc.Exists)
				f.Data.DataTable.Close("dtEDesc")
			f.Intrinsic.Control.EndIf
			
			f.Intrinsic.Control.If(v.Screen.frmSelectVend!chkCopySOExtraDesc.Value,=,1)
				f.Intrinsic.String.Build("SELECT TEXT FROM ORDER_LN_TEXT WHERE ORDER_NUM='{0}' AND ORDER_LINE='{1}0'",v.Local.sTemp(0).trim,v.Local.sTemp(1).trim,v.Local.sSQL)
				f.Data.DataTable.CreateFromSQL("dtEDesc","con",v.Local.sSQL)
				f.Intrinsic.Control.For(v.Local.j,0,v.DataTable.dtEDesc.RowCount--,1)
					f.Intrinsic.String.Concat(v.Local.sEDes,v.DataTable.dtEDesc(v.Local.J).Text!fieldvaltrim,v.Local.sEDes)
				f.Intrinsic.Control.Next(v.Local.j)
			f.Intrinsic.Control.EndIf
			
			'Do the link back to the user fields
			f.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_2='{0}', USER_3='{1}' WHERE ORDER_NO='{2}' AND RECORD_NO='{3}0'",V.DataTable.dtPOTemp(v.Local.i).PURCHASE_ORDER!FIELDVALTRIM,v.DataTable.dtPOTemp(v.Local.i).RECORD_NO!FIELDVALTRIM,v.Local.sTemp(0),v.Local.sTemp(1),v.Local.sSQL)
			F.ODBC.Connection!con.execute(v.Local.ssql)
			
			
			'Update the description back to original state
			f.Intrinsic.String.Build("UPDATE PO_LINES SET DESCRIPTION='{0}', USER_5='SO#: {3}' WHERE PURCHASE_ORDER='{1}' AND RECORD_NO='{2}'",v.Local.sDesc,v.DataTable.dtPOTemp(v.Local.i).PURCHASE_ORDER!FIELDVALTRIM,v.DataTable.dtPOTemp(v.Local.i).RECORD_NO!FIELDVALTRIM,v.DataTable.dtPOTemp(v.Local.i).DESCRIPTION!FIELDVALTRIM,v.Local.sSQL)
			f.ODBC.Connection!con.execute(v.Local.ssql)
			
			'Add extra text to PO
			f.Intrinsic.Control.If(v.Screen.frmSelectVend!chkCopySOExtraDesc.Value,=,1)
				f.Intrinsic.Control.CallSub(addPOText,"PONum",v.DataTable.dtPOTemp(v.Local.i).PURCHASE_ORDER!FIELDVALTRIM,"POLn",v.DataTable.dtPOTemp(v.Local.i).RECORD_NO!FIELDVALTRIM,"POText",v.Local.sEDes)
			f.Intrinsic.Control.EndIf
			
			V.Local.sEDes.Set("")
			
		f.Intrinsic.Control.EndIf
	f.Intrinsic.Control.Next(v.Local.i)
	f.Intrinsic.UI.CloseWaitDialog
	f.Intrinsic.Control.CallSub(frmSelectVend_Unload)
	f.Intrinsic.Control.CallSub(cmdRefresh_Click)
	
	gui.FrmOrderReview.GsGCAllOpen.enabled(true)
f.Intrinsic.Control.Catch
	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
f.Intrinsic.Control.EndTry
Program.Sub.cmdNewPO_Click.End

Program.Sub.Form_UnLoad.Start
Program.Sub.Form_UnLoad.End

Program.Sub.frmSelectVend_UnLoad.Start
f.Data.DataTable.Close("dtPO")
gui.frmSelectVend..Visible(false)
Program.Sub.frmSelectVend_UnLoad.End

Program.Sub.cmdVendBrw_Click.Start
V.Local.sRet.Declare(String)
V.Local.sTitles.Declare(String)
V.Local.iWidths.Declare(String)
V.Local.stemp.Declare(String)
V.Local.ssql.Declare(String)

f.Intrinsic.UI.SetBrowserHotTypeAhead(true)

F.intrinsic.string.split("Vendor No.*!*Vendor Name","*!*",v.local.sTitles)
F.intrinsic.string.split("2000*!*3000","*!*",v.local.iWidths)

V.Local.ssql.set("SELECT VENDOR, NAME_VENDOR FROM V_VENDOR_MASTER")

F.intrinsic.ui.browser("Select a Vendor Code",con,v.Local.ssql,v.local.sTitles,v.local.iWidths,v.local.sRet)

F.intrinsic.control.if(v.local.sRet,"=","***CANCEL***")
F.intrinsic.control.else
  	F.intrinsic.string.split(v.local.sRet,"*!*",v.local.sRet)
  	gui.frmSelectVend.txtVendorNo.Text(v.Local.sRet(0))
F.Intrinsic.Control.endif

Program.Sub.cmdVendBrw_Click.End

Program.Sub.gsgcLines_RowCellClick.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare
	v.Local.sPart.Declare
	V.Local.sGSSPart.Declare
	Gui.frmSelectVend.gsgcLines.GetCellValueByColumnName("gvPO","GPrt",V.Args.RowIndex,V.Local.sGssPart)
	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("Part")
			f.Data.DataTable.AddRow("300011","Part",v.Local.sGssPart,"Location","","Switch","M")
			f.Intrinsic.Control.CallSub(300011Async)
	f.Intrinsic.Control.EndSelect
f.Intrinsic.Control.Catch
	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
	f.ODBC.Connection!con.Close
	f.Intrinsic.Control.End
f.Intrinsic.Control.EndTry
Program.Sub.gsgcLines_RowCellClick.End

Program.Sub.acMenuItems_ElementClick.Start
F.Intrinsic.Control.Try

	gui.FrmOrderReview.progressBar1.SetFocus(1)
	
	f.Intrinsic.Control.SelectCase(v.Args.Caption)
		'f.Intrinsic.Control.Case("Auto Purchase Order Generation")
			'f.Intrinsic.Control.CallSub(cmdCreatePO_click)
			
		f.Intrinsic.Control.Case("Auto Work Order Generation")
			f.Intrinsic.Control.CallSub(cmdBWDSched_Click)
			
		f.Intrinsic.Control.Case("Open Part Documents")
			f.Intrinsic.Control.CallSub(cmdOpenDoc_Click)
			
		f.Intrinsic.Control.Case("Print Work Order Documents")
			f.Intrinsic.Control.CallSub(cmdPrintDoc_Click)
		
		f.Intrinsic.Control.Case("Reschedule Work Order")
			f.Intrinsic.Control.CallSub(cmdResched_Click)
		
		f.Intrinsic.Control.Case("Create/Verify BOM")
			f.Intrinsic.Control.CallSub(cmdCreateBOM_Click)
		
		f.Intrinsic.Control.Case("Create/Verify Part")
			f.Intrinsic.Control.CallSub(cmdCreateParts_Click)
			
		f.Intrinsic.Control.Case("Create/Verify Router")
			f.Intrinsic.Control.CallSub(cmdCreateRtr_Click)
			
		f.Intrinsic.Control.Case("New Work Order")
			f.Intrinsic.Control.CallSub(MenuClickNewWO)
		
		f.Intrinsic.Control.Case("New Sales Order")
			f.Intrinsic.Control.CallSub(MenuClickNewSO)
			
		f.Intrinsic.Control.Case("Copy Sales Order")
			f.Intrinsic.Control.CallSub(cmdCopySO_Click)
			
		
		
	f.Intrinsic.Control.EndSelect

F.Intrinsic.Control.Catch
	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
	f.ODBC.Connection!con.Close
	f.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.acMenuItems_ElementClick.End

Program.Sub.FrmOrderReview_ExportClick.Start
f.Intrinsic.Control.Try
	f.Intrinsic.Control.CallSub(MenuClickExport)
f.Intrinsic.Control.Catch
	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
	f.ODBC.Connection!con.Close
	f.Intrinsic.Control.End
f.Intrinsic.Control.EndTry
Program.Sub.FrmOrderReview_ExportClick.End

Program.Sub.FrmOrderReview_RefreshClick.Start
f.Intrinsic.Control.Try
	F.Intrinsic.Control.CallSub(cmdRefresh_Click)
f.Intrinsic.Control.Catch
	f.Intrinsic.UI.Msgbox(v.Ambient.ErrorDescription)
	f.ODBC.Connection!con.Close
	f.Intrinsic.Control.End
f.Intrinsic.Control.EndTry
Program.Sub.FrmOrderReview_RefreshClick.End

'GSS CI Arturo Almaguer modification 7/11/22
'New subroutines to account for requested changes

Program.Sub.MenuClickSA.Start
'This subroutine allows the user to select/unselect all gridview records

F.Intrinsic.Control.Try
	
	V.Local.sReturn.Declare(String)
	V.Local.sError.Declare(String)
	v.Local.sRet.Declare(String)
	v.Local.iCounter.Declare(Long)
	
	GUI.FrmOrderReview.GsGCAllOpen.SuspendLayout
	GUI.FrmOrderReview.GsGCAllOpen.Visible(False)
	
	F.Intrinsic.Control.If(V.Args.ItemName,=,"SELECTALL")
	
		GUI.FrmOrderReview.GsGCAllOpen.GetSelectedRows("gvAll",v.Local.sRet)
		f.Intrinsic.Control.If(v.Local.sRet,=,"")
			f.Intrinsic.UI.Msgbox("No rows selected")
			GUI.FrmOrderReview.GsGCAllOpen.Visible(True)
			GUI.FrmOrderReview.GsGCAllOpen.ResumeLayout
			f.Intrinsic.Control.ExitSub
		f.Intrinsic.Control.EndIf
	
		f.Intrinsic.String.Split(v.Local.sRet,"*!*",v.Local.sRet)
		f.Intrinsic.Control.For(v.Local.iCounter,0,v.Local.sRet.UBound,1)
			f.Data.DataTable.SetValue("dtAll",v.Local.sRet(v.Local.iCounter),"ScheduleWO",True)
		f.Intrinsic.Control.Next(v.Local.iCounter)
		
	F.Intrinsic.Control.ElseIf(V.Args.ItemName,=,"UNSELECTVISIBLE")
	
		GUI.FrmOrderReview.GsGCAllOpen.GetSelectedRows("gvAll",v.Local.sRet)
		f.Intrinsic.Control.If(v.Local.sRet,=,"")
			f.Intrinsic.UI.Msgbox("No rows selected")
			GUI.FrmOrderReview.GsGCAllOpen.Visible(True)
			GUI.FrmOrderReview.GsGCAllOpen.ResumeLayout
			f.Intrinsic.Control.ExitSub
		f.Intrinsic.Control.EndIf
	
		f.Intrinsic.String.Split(v.Local.sRet,"*!*",v.Local.sRet)
		f.Intrinsic.Control.For(v.Local.iCounter,0,v.Local.sRet.UBound,1)
			f.Data.DataTable.SetValue("dtAll",v.Local.sRet(v.Local.iCounter),"ScheduleWO",False)
		f.Intrinsic.Control.Next(v.Local.iCounter)
		
	F.Intrinsic.Control.EndIf

	GUI.FrmOrderReview.GsGCAllOpen.Visible(True)
	GUI.FrmOrderReview.GsGCAllOpen.ResumeLayout

F.Intrinsic.Control.Catch
	
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub("FrmOrderReview_UnLoad")
	
F.Intrinsic.Control.EndTry
Program.Sub.MenuClickSA.End

Program.Sub.FormMassUpdate_UnLoad.Start
'This subroutine closes MassUpdate form to go back to main gridview

'Making MassUpdate form invisible and setting focus on Order Review one
GUI.FormMassUpdate..Visible(False)
GUI.FrmOrderReview..SetFocus
GUI.FrmOrderReview..Enabled(True)

Program.Sub.FormMassUpdate_UnLoad.End

Program.Sub.MenuClickMassUpdate.Start
'This subroutine displays MassUpdate form

'Disabling main view so user isnt able to do any other process while Mass Update form is shown
GUI.FrmOrderReview..Enabled(False)
GUI.FormMassUpdate.cmdMassUpdate.Enabled(True)
GUI.FormMassUpdate..Show

Program.Sub.MenuClickMassUpdate.End

Program.Sub.cmdMassUpdate_Click.Start
'This subroutine updates the SO Due Date for all the selected records based on the selected date.

F.Intrinsic.Control.Try

	v.Local.iCounter.Declare(Long)
	v.Local.dNewSODueDate.Declare(Date)
	v.Local.sDate.Declare(String)
	v.Local.sDateLong.Declare(String)
	v.Local.sSQL.Declare(String)
	v.Local.sJob.Declare(String)
	v.Local.sSuffix.Declare(String)
	v.Local.sReturn.Declare(String)
	
	'Disabling control so user doesn't click on it again if update process takes a while
	GUI.FormMassUpdate.cmdMassUpdate.Enabled(False)
	
	'Validating if dv exists, closing if it does.
	F.Intrinsic.Control.If(V.DataView.dtAll!dvAll.Exists)
		F.Data.DataView.Close("dtAll", "dvAll")
	F.Intrinsic.Control.EndIf
	
	'Creating dv to get only selected records
	F.Data.DataView.Create("dtAll", "dvAll", 22, "[ScheduleWO] = True","")
	
	'Setting new SO Due Date to date picker's selected date
	V.Local.dNewSODueDate.Set(V.Screen.FormMassUpdate!dtpMassUpdate.Value)
	
	'Validating if there are selected records 
	F.Intrinsic.Control.If(V.DataView.dtAll!dvAll.RowCount, >, 0)
	
		'Looping through dv
		F.Intrinsic.Control.For(V.Local.iCounter, 0, V.DataView.dtAll!dvAll.RowCount--, 1) 
		
			'Updating SO Due Date fields at line level
			f.Intrinsic.String.Format(V.Local.dNewSODueDate,"MMDDYY",v.Local.sDate)
			f.Intrinsic.String.Format(v.Local.dNewSODueDate,"YYYYMMDD",v.Local.sDateLong)
			F.Intrinsic.String.Concat("UPDATE ORDER_LINES SET DATE_ITEM_PROM='",v.Local.sDateLong,"', ITEM_PROMISE_DT='",v.Local.sDate,"' WHERE Order_No='",v.DataView.dtAll!dvAll(V.Local.iCounter).SO!FieldValTrim,"' and Record_No='",v.DataView.dtAll!dvAll(V.Local.iCounter).SOLine!FieldValTrim,"0'",V.Local.sSQL)
			F.ODBC.Connection!con.Execute(v.Local.sSQL)
		
			'Updating WO Due Date based on the new SO Due Date
			V.Local.sJob.Set(V.DataView.dtAll!dvAll(V.Local.iCounter).WO!FieldValTrim)
			V.Local.sSuffix.Set(V.DataView.dtAll!dvAll(V.Local.iCounter).SUFFIX!FieldValTrim)
			F.Intrinsic.String.Concat("UPDATE JOB_HEADER SET DATE_DUE='",v.Local.sDate,"' WHERE JOB='",v.Local.sJob,"' and SUFFIX='",V.Local.sSuffix,"'",V.Local.sSQL)
			F.ODBC.Connection!con.Execute(v.Local.sSQL)
			
			'Setting new SO Due Date to show in main grid without refreshing
			f.Data.DataView.SetValue("dtAll", "dvAll", V.Local.iCounter, "SoDueDate", V.Local.dNewSODueDate)
			
		F.Intrinsic.Control.Next(V.Local.iCounter)
		
		'Unselecting all selected values
		f.Data.DataView.SetValue("dtAll", "dvAll", -1, "ScheduleWO", False)
		
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No records were selected. Cancelling Mass SO Due Date update process.", "ERROR")
	F.Intrinsic.Control.EndIf
	
	'Calling sub to close Mass Update Form
	F.Intrinsic.Control.CallSub("FormMassUpdate_UnLoad")

F.Intrinsic.Control.Catch
	
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub("FrmOrderReview_UnLoad")
	
F.Intrinsic.Control.EndTry
Program.Sub.cmdMassUpdate_Click.End

Program.Sub.MenuClickUnselectAll.Start
'This subroutine unselects all selected grid records

F.Intrinsic.Control.Try

	V.Local.sError.Declare(String)
	v.Local.iCounter.Declare(Long)
	
	GUI.FrmOrderReview.GsGCAllOpen.SuspendLayout
	GUI.FrmOrderReview.GsGCAllOpen.Visible(False)
	
	f.Intrinsic.Control.For(v.Local.iCounter,0, V.DataTable.dtAll.RowCount--,1)
		f.Data.DataTable.SetValue("dtAll",v.Local.iCounter,"ScheduleWO",False)
	f.Intrinsic.Control.Next(v.Local.iCounter)
		
	GUI.FrmOrderReview.GsGCAllOpen.Visible(True)
	GUI.FrmOrderReview.GsGCAllOpen.ResumeLayout

F.Intrinsic.Control.Catch
	
	F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub("FrmOrderReview_UnLoad")
	
F.Intrinsic.Control.EndTry
Program.Sub.MenuClickUnselectAll.End

Program.Sub.GetUserFields.Start
v.Local.sSql.Declare(String)

v.Local.sSql.Set("Select KEY_ID, LABEL from V_OE_USER_FLDS_LN")
f.Data.DataTable.CreateFromSQL("dtUserFields","con",v.Local.sSql,True)

f.Intrinsic.Control.ExitSub
Program.Sub.GetUserFields.End

Program.Sub.Comments.Start
${$5$}$2.0.0.0$}$2
${$6$}$bbaker$}$20230823154958772$}$pM7xsHplA2E9VCTenDTJ47gi1rF/t66WIO4JG5sWH9UDtiqLBPXG1r4/gc5k8i+99Gob1Hx5hNk=
Program.Sub.Comments.End
